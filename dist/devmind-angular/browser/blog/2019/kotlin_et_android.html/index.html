<!DOCTYPE html><html lang="en" data-critters-container><head>
  <meta charset="utf-8">
  <title>Blog</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    body {
      min-height: 100vh;
      max-height: 100vh;
      font-family: "Helvetica", "Arial", "sans-serif";
      padding: 0;
      margin: 0;
    }

    header {
      height: 90px;
      max-height: 90px;
      box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      background-color: white;
      display: -webkit-flex;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
      z-index: 99;
      transition-duration: 0.2s;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-property: max-height, box-shadow;
      position: fixed;
      width: 100%;
      text-align: center;
    }
    header hr {
      width:100%;
      background-color: #424242;
      border-color: #424242;
      display: block;
      border: 0;
      height: 0.5em;
      margin: 0;
    }
    .header-img {
      margin: auto;
      width: 50%;
      padding-top: 0.5em;
      height: 30px;
    }
    .header-img img {
      max-height: 30px !important;
    }
    .header-space {
      min-height: 90px;
    }


    @media screen and (min-width: 901px) {
      header {
        height: 120px;
        max-height: 120px;
      }
      .header-img {
        height: 60px;
      }
      .header-img img {
        max-height: 60px !important;
      }
      .header-space {
        min-height: 120px;
      }
      nav a {
        padding: 6px 24px;
      }
      .nav-home{
        display: block !important;
      }
    }


    nav {
      display: -webkit-flex;
      display: flex;
      margin: auto;
    }

    nav a {
      padding: 0 12px;
      line-height: 28px;
      height: 28px;
      color: #424242;
      margin: auto;
      text-decoration: none;
      text-transform: uppercase;
      font-weight: 600;
      font-size: 13px;
      border-radius: 4px;
    }
    .nav-home{
      display: none;
    }
    nav a > img {
    // height: 20px;
    }

    nav a:hover {
      background-color: #9e9e9e;
    }

    nav .active {
      background-color: rgba(0, 0, 0, 0.14);
    }

    main {
      overflow-x: hidden;
    }

    img, picture {
      max-width: 100%;
      height: auto;
      margin: auto;
    }

    * {
      box-sizing: border-box; /* pour maîtriser width et flex-basis */
    }

    .devmind-section {
      display: block;
      margin: 0 auto;
      max-width: 1600px;
      padding: 60px 40px;
    }

    @media (max-width: 700px) {
      .devmind-section {
        padding: 25px 10px;
      }
    }

    @media (min-width: 701px) and (max-width: 900px) {
      .devmind-section {
        padding: 40px 25px;
      }
    }

    .dm-social {
      min-width: 2em;
      max-width: 2em;
      width: 2em;
      height: 2em;
    }
  </style>
  <script>
    function copyToClipboard(id) {
      const text = document.getElementById(id).innerText
        .replaceAll('~$', '')
        .replaceAll('(1)', '')
        .replaceAll('(2)', '')
        .replaceAll('(3)', '')
        .replaceAll('(4)', '')
        .replaceAll('(5)', '')
        .replaceAll('(6)', '')
        .replaceAll('(7)', '')
        .replaceAll('(8)', '')
        .replaceAll('(9)', '')
        .replaceAll('(10)', '')
      ;
      navigator.clipboard.writeText(text.substring(0, text.length));
    }
  </script>
<style>code[class*=language-]{color:#555;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}.imageblock{text-align:center}blockquote>.paragraph{box-shadow:0 4px 5px #00000024,0 1px 10px #0000001f,0 2px 4px -1px #0003;padding:1em;background-color:#424242;color:#fff;border-radius:4px}.toc{background:#f0f8ff;padding:1em}h1,h2{font-weight:100}h1{font-size:35px;line-height:38px}.dm-block--blog{width:100%;background-color:#eceff1;color:#424242;padding:0;margin:0}.dm-block--blog a,.dm-block--blog a:hover,.dm-block--blog a:visited{font-weight:700;color:#424242;text-decoration:none;cursor:pointer}.dm-block--blog a:hover{color:#424242;text-decoration:underline}.dm-block--blog .link{display:block}.btn-copy-code{background-color:#fff;border:2px solid white;border-radius:24px;color:#424242!important;margin:1em .5em auto auto;font-weight:700;font-size:16px;display:block;cursor:pointer;width:auto;text-align:center;box-shadow:0 4px 5px #00000024,0 1px 10px #0000001f,0 2px 4px -1px #0003;padding:4px;font-size:small}.btn-copy-code:hover{background-color:#424242;border:2px solid #424242;color:#fff!important;padding:.5em 1em}footer{background-color:#424242}.is-small-screen{display:none}.is-large-screen{display:inherit}@media screen and (max-width: 900px){.is-small-screen{display:inherit}.is-large-screen{display:none}}h1,h2{color:#424242;font-weight:100}h1{font-weight:bolder;font-size:35px;line-height:38px}h2{font-size:25px;line-height:28px}@media (max-width: 700px){h1{font-size:28px;line-height:30px}h2{font-size:22px;line-height:24px}}
</style><link rel="stylesheet" href="styles-2TVDB7GC.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles-2TVDB7GC.css"></noscript><style ng-app-id="ng">.dm_footer[_ngcontent-ng-c2660501952]{color:#eee;display:flex;justify-content:space-between;font-size:14px}.dm_footer[_ngcontent-ng-c2660501952]   .dm_society[_ngcontent-ng-c2660501952]{color:#fff}.dm_footer[_ngcontent-ng-c2660501952]   div[_ngcontent-ng-c2660501952]{margin-right:1em;width:100%}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__middle[_ngcontent-ng-c2660501952]{flex-grow:1}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__right[_ngcontent-ng-c2660501952]{text-align:right}.dm_footer[_ngcontent-ng-c2660501952]   .is-large-screen[_ngcontent-ng-c2660501952]{padding:.7em;margin:.7em 1em}.dm_footer[_ngcontent-ng-c2660501952]   .is-small-screen[_ngcontent-ng-c2660501952]{padding:0;margin:0 1em;font-size:12px}</style><style ng-app-id="ng">h1{margin-top:.5em}.dm-blog--info-date{font-size:smaller;color:#424242;border:1px solid #aaa;border-radius:24px;padding:.5em 1em;margin-right:.5em;display:inline}.blog-keywords{display:flex;margin-bottom:1em}.blog-keywords .dm-blog--keyword-detail{background-color:#ccc;color:#424242;padding:.5em 1em;margin-right:.5em;border-radius:24px;font-size:smaller}.toc{background-color:#ccc;margin-top:1em;border:1px solid #ccc;padding:1em;border-radius:8px}.toc #toctitle{font-weight:700;margin-bottom:.5em}img{max-width:100%;height:auto}.imageblock>.content{display:flex;justify-content:center;align-items:center}.highlight{display:block;overflow-x:auto;background:#f3f3f3;color:#444;padding:1.5em;box-shadow:0 8px 16px #00000026;border-radius:8px}code.hljs{padding:3px 5px}.hljs-comment{color:#697070}.hljs-punctuation,.hljs-tag{color:#444a}.hljs-tag .hljs-attr,.hljs-tag .hljs-name{color:#444}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-link,.hljs-operator,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#ab5656}.hljs-literal{color:#695}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta .hljs-string{color:#38a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.language-kotlin:before{display:block;float:right;content:"kotlin";font-weight:700;text-transform:uppercase}.language-typescript:before{display:block;float:right;content:"typescript";font-weight:700;text-transform:uppercase}.language-java:before{display:block;float:right;content:"java";font-weight:700;text-transform:uppercase}.language-javascript:before{display:block;float:right;content:"javascript";font-weight:700;text-transform:uppercase}.language-shell:before{display:block;float:right;content:"shell";font-weight:700;text-transform:uppercase}.language-yaml:before{display:block;float:right;content:"yaml";font-weight:700;text-transform:uppercase}.language-json:before{display:block;float:right;content:"json";font-weight:700;text-transform:uppercase}.language-xml:before{display:block;float:right;content:"xml";font-weight:700;text-transform:uppercase}.language-html:before{display:block;float:right;content:"html";font-weight:700;text-transform:uppercase}.language-css:before{display:block;float:right;content:"css";font-weight:700;text-transform:uppercase}.language-scss:before{display:block;float:right;content:"scss";font-weight:700;text-transform:uppercase}
</style></head>
<body><!--nghm-->
  <app-root _nghost-ng-c582792440 ng-version="18.0.0" ngh="2" ng-server-context="ssg"><app-header _ngcontent-ng-c582792440 _nghost-ng-c2882497807 ngh="0"><header _ngcontent-ng-c2882497807><div _ngcontent-ng-c2882497807 class="header-img"><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" href="/"><img _ngcontent-ng-c2882497807 src="img/logo/logo_long.svg" alt="Dev-Mind" title="Dev-Mind"></a></div><nav _ngcontent-ng-c2882497807><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" class="nav-home" href="/"><img _ngcontent-ng-c2882497807 src="/img/ic_home_white_24px.svg" rel="start" alt="Accueil"></a><a _ngcontent-ng-c2882497807 routerlink="/formations.html" aria-label="Formations" class href="/formations.html"> Formations</a><a _ngcontent-ng-c2882497807 routerlink="/blog.html" aria-label="Blog" class="active" href="/blog.html">Blog</a><a _ngcontent-ng-c2882497807 routerlink="/experience.html" aria-label="Experience" class href="/experience.html"> Expérience</a></nav><hr _ngcontent-ng-c2882497807></header><div _ngcontent-ng-c2882497807 class="header-space"></div></app-header><router-outlet _ngcontent-ng-c582792440></router-outlet><app-asciidoc-viewer ngh="1"><div class="dm-block--blog"><div class="devmind-section"><h1><!--ngetn--></h1><div class="blog-keywords"><div class="dm-blog--info-date">07/06/2019</div><div class="dm-blog--keyword-detail">Android</div><!---->&nbsp; </div><div class="preview"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a class="link" fragment="#_kotlin_simplifie_la_syntaxe">Kotlin simplifie la syntaxe</a></li>
<li><a class="link" fragment="#_null_safety">Null safety</a></li>
<li><a class="link" fragment="#_immutabilité">Immutabilité</a></li>
<li><a class="link" fragment="#_valeurs_par_défaut">Valeurs par défaut</a></li>
<li><a class="link" fragment="#_classes">Classes</a>
<ul class="sectlevel2">
<li><a class="link" fragment="#_classes_pojo">Classes POJO</a></li>
<li><a class="link" fragment="#_classes_internes">Classes internes</a></li>
<li><a class="link" fragment="#_classes_anonymes">Classes anonymes</a></li>
</ul>
</li>
<li><a class="link" fragment="#_extensions_de_fonction">Extensions de fonction</a></li>
<li><a class="link" fragment="#_fonctions_dordre_supérieur">Fonctions d’ordre supérieur</a>
<ul class="sectlevel2">
<li><a class="link" fragment="#_exemple_dans_le_langage">Exemple dans le langage</a></li>
<li><a class="link" fragment="#_ecrire_un_dsl">Ecrire un DSL</a></li>
<li><a class="link" fragment="#_android">Android</a></li>
</ul>
</li>
<li><a class="link" fragment="#_coroutines">Coroutines</a>
<ul class="sectlevel2">
<li><a class="link" fragment="#_conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>En 2017 une grande annonce a été faite à <a href="https://www.youtube.com/watch?v=fPzxfeDJDzY&amp;list=PLWz5rJ2EKKc-odHd6XEaf7ykfsosYyCKp&amp;index=51&amp;t=0s">Google IO</a>. Le langage <a href="https://kotlinlang.org/">Kotlin</a> devenait le deuxième langage de référence pour développer des applications Android. <a href="https://kotlinlang.org/">Kotlin</a> a été créé par la société <a href="https://www.jetbrains.com/">JetBrains</a>, éditeur de <a href="https://developer.android.com/studio/">Android Studio</a> (IDE de référence pour le développement Android). <a href="https://www.jetbrains.com/">JetBrains</a> collabore depuis plusieurs année avec Google pour toujours améliorer ce studio de développement. Ce studio a été initialement été écrit en Java puis en Kotlin.</p>
</div>
<div class="paragraph">
<p>Pourquoi Google a t’il fait cette annonce ? Etait ce lié au procès avec la société Oracle sur l’utilisation de Java ?  Etait ce lié aux possibilités offertes par ce langage ? Etait ce lié aux possibilités offertes par cette collabiration étroite entre les deux sociétés ?</p>
</div>
<div class="paragraph">
<p>Personnellement je pense que Kotlin a été adopté pour toutes ces raisons. <a href="https://kotlinlang.org/">Kotlin</a> a essayé de mêler le meilleur de différents langages et je trouve qu’il a véritablement redonné un coup de boost aux développeurs Android (moi le premier). Deux ans après, <a href="https://android-developers.googleblog.com/2019/05/kotlin-is-everywhere-join-global-event.html">50% des développeurs Android</a> utilisent Kotlin.</p>
</div>
<div class="paragraph">
<p>En mai à Google I/O 2019, Google a <a href="https://android-developers.googleblog.com/2019/05/google-io-2019-empowering-developers-to-build-experiences-on-Android-Play.html">annoncé</a> une nouvelle étape dans l’adoption de Kotlin. Les développements Android deviennent Kotlin-first. Google conseille aux développeurs d’utiliser Kotlin pour les nouveaux développements. En interne, les librairies commencent aussi à être écrite directement en Kotlin. Comme Kotlin est 100% interopérable avec Java ce virage ne va pas pénaliser les projets existants.</p>
</div>
<div class="paragraph">
<p>Dans cet article, nous allons revenir sur les intérêts du langage pour comprendre pourquoi Kotlin est devenu le langage de référence pour les développements Android.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../img/blog/2019/kotlin_et_android.png" alt="Kotlin et Android">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kotlin_simplifie_la_syntaxe">Kotlin simplifie la syntaxe</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quand nous utilisons le langage Java et tout particulièrement quand nous devons écrire une application Android, nous devons écrire beaucoup de code fastidieux. Kotlin met en avant le pragmatisme et la simplicité.</p>
</div>
<div class="paragraph">
<p>La philosophie de Kotlin est :</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Tout ce qui peut être déduit par le compilateur, n’a pas besoin d’être écrit par le développeur.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Prenons l’exemple d’une classe Java permettant d’être exécutée et d’afficher un message <code>Hello World</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" id="1731447062616.8582"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorld</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Dev-Mind"</span>;
        System.out.println(<span class="hljs-string">"Hello world "</span> + name);
    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062616.8582')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>En Kotlin vous pouvez faire la même chose en écrivant</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062617.296"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">val</span> name = <span class="hljs-string">"Dev-Mind"</span>
    println(<span class="hljs-string">"Hello world $name"</span>)
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062617.296')">Copy</button></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>La visibilité <code>public</code> est celle par défaut et donc plus besoin de la définir à chaque fois</p>
</li>
<li>
<p>Vous pouvez écrire des fonctions non attachées à une classe (le compilateur le fera pour vous)</p>
</li>
<li>
<p>Les points virgules ne sont plus nécéssaires</p>
</li>
<li>
<p>Kotlin fait beaucoup d’inférence de type et vous n’avez pas besoin de définir le type si le compilateur peut le déduire (exemple du name)</p>
</li>
<li>
<p>Vous pouvez utiliser des templates de String et directement accéder au contenu d’une variable avec <code>$</code></p>
</li>
<li>
<p>…​</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_null_safety">Null safety</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L’erreur la plus courante pour un développeur Java, est de se retrouver avec un programme qui plante suite à une exception <code>Null Pointer Exception</code>. En Java, un objet non alloué à une référence nulle. En Kotlin le null est interdit. Vous aurez une erreur de compilation si vous déclarer un objet et que ce dernier n’est pas initilialisé. Si vraiment vous voulez gérer une valeur nulle, tout le système de type a été doublé et vous pouvez ajouter <code>?</code> à un type pour dire qu’une valeur peut être nulle</p>
</div>
<div class="paragraph">
<p>Par exemple</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062617.0767"><span class="hljs-keyword">var</span> name:String         <span class="hljs-comment">// Erreur de compilation</span>
<span class="hljs-keyword">var</span> name:String = <span class="hljs-literal">null</span>  <span class="hljs-comment">// Erreur de compilation</span>
<span class="hljs-keyword">var</span> name = <span class="hljs-string">"Dev-Mind"</span>   <span class="hljs-comment">// Valide et pas besoin de définir un type car le compilateur peut le deviner</span>
<span class="hljs-keyword">var</span> name:String? = <span class="hljs-literal">null</span> <span class="hljs-comment">// Valide car on utilise le type String? qui veut dire String nullable</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731447062617.0767')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Au premier abord, cette fonctionnalité peut paraître contraignante mais c’est un réel plaisir à l’utiliser et ceci évite bon nombre de bugs d’inadvertance.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_immutabilité">Immutabilité</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une autre force de Kotlin est de préconiser l’immutabilité. Quand vous définissez une valeur avec le mot clé <code>val</code> elle est non mutable. Si vous voulez changer une référence plus tard vous devrez utiliser le mot clé <code>var</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062618.539"><span class="hljs-keyword">val</span> name = <span class="hljs-string">"Dev-Mind"</span>
name = <span class="hljs-string">"Guillaume"</span>      <span class="hljs-comment">// Erreur de compilation car immutable</span>

<span class="hljs-keyword">var</span> name2 = <span class="hljs-string">"Dev-Mind"</span>
name2 = <span class="hljs-string">"Guillaume"</span>     <span class="hljs-comment">// OK car mutable</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731447062618.539')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Kotlin implémente les API Java pour les listes mais distingue les listes mutables et non mutables. Par défaut tout est immutable. Si vous voulez une liste mutable vous devez le préciser</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062618.1362"><span class="hljs-keyword">val</span> names = listOf(<span class="hljs-string">"Dev-Mind"</span>, <span class="hljs-string">"Guillaume"</span>)
names.add(<span class="hljs-string">"NewName"</span>)    <span class="hljs-comment">// Erreur de compilation car add n'existe pas sur une liste immutable</span>


<span class="hljs-keyword">val</span> names = mutableListOf(<span class="hljs-string">"Dev-Mind"</span>, <span class="hljs-string">"Guillaume"</span>)
names.add(<span class="hljs-string">"NewName"</span>)</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062618.1362')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Même si Kotlin distingue les listes mutables et non mutables, Kotlin n’a pas réinventé de nouvelles classes pour gérer les listes. Kotlin s’appuie sur les types existants Java.</p>
</div>
<div class="paragraph">
<p>Kotlin vous pousse à appliquer des principes de la programmation fonctionnelle (dont l’immutabilité) pour le plus grand bien de votre code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_valeurs_par_défaut">Valeurs par défaut</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kotlin vous permet de préciser des valeurs par défaut à vos différents paramètres de vos méthodes</p>
</div>
<div class="paragraph">
<p>Par exemple avec le code suivant,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062619.9778"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">formatDate</span><span class="hljs-params">(string: <span class="hljs-type">Date</span>, format: <span class="hljs-type">String</span> = <span class="hljs-string">"yyyy-MM-dd"</span>, addDay: <span class="hljs-type">Int</span> =<span class="hljs-number">0</span>)</span></span> : String</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062619.9778')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>vous pouvez avoir différentes manières d’appeler cette méthode</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062619.3516">formatDate(Date())              <span class="hljs-comment">// On ne précise pas les valeurs si celles par défaut sont suffisantes</span>
formatDate(Date(), <span class="hljs-string">"yyyy"</span>)      <span class="hljs-comment">// Dans mon cas je ne change que la deuxième valeur</span>
formatDate(Date(), addDay = <span class="hljs-number">2</span>)  <span class="hljs-comment">// Si je veux préciser une valeur particulière je peux u tiliser les paramètres nommés</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731447062619.3516')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Les paramètres nommés (comme sur la dernière ligne de notre exemple) sont très pratiques quand vous voulez apporter plus de lisibilité à votre code. Par exemple si vous avez la méthode suivante</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062620.947"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findSpeaker</span><span class="hljs-params">(firstname: <span class="hljs-type">String</span>, lastname: <span class="hljs-type">String</span>)</span></span>: Speaker</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062620.947')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Quand vous appelez votre méthode sans nommer les paramètres vous ne savez jamais si c’est le nom ou prénom qui est en premier. Il suffit que votre collègue change la signature et inverse l’ordre des paramètres et vous avez un bug totalement transparent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062620.2517"><span class="hljs-keyword">val</span> speaker1 = findSpeaker(<span class="hljs-string">"Chet"</span>, <span class="hljs-string">"Haase"</span>)
<span class="hljs-keyword">val</span> speaker1 = findSpeaker(firstname = <span class="hljs-string">"Chet"</span>, lastname = <span class="hljs-string">"Haase"</span>)  <span class="hljs-comment">// les paramètres nommés amènent plus de lisibilité</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731447062620.2517')">Copy</button></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_classes">Classes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les classes sont bien évidemment disponible en Kotlin. Prenons un exemple pour regarder les différences avec les classes Java.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" id="1731447062620.8315"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span>{ }</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062620.8315')">Copy</button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" id="1731447062621.5364"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Parent</span>{}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062621.5364')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>En Java ces deux classes publiques doivent être définies dans 2 fichiers .java différent. En Kotlin vous pouvez écrire le tout dans un seul fichier</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062621.7405"><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> : <span class="hljs-type">Parent</span>()</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062621.7405')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Notez que la classe mère doit être précédée du mot clé <code>open</code>. Par défaut les classes Kotlin sont définies comme <code>public final</code>. Si vous voulez ouvrir une classe à la surcharge, vous devrez le préciser.</p>
</div>
<div class="sect2">
<h3 id="_classes_pojo">Classes POJO</h3>
<div class="paragraph">
<p>Un POJO (Plain Old Java Object) est une simple classe qui va contenir des données. Généralement sur ce type d’objet</p>
</div>
<div class="ulist">
<ul>
<li>
<p>nous définissons des propriétés private</p>
</li>
<li>
<p>nous générons des constructeurs avec les valeurs obligatoires</p>
</li>
<li>
<p>nous générons des méthodes pour lire et modifier ces propriétés: getter, setter</p>
</li>
<li>
<p>nous générons des méthodes hashcode, equals, copy</p>
</li>
<li>
<p>et parfois nous écrivons aussi des builders pour créer rapidement et partiellement une instance de notre objet</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Si j’essaie de créer une classe <code>Speaker</code> avec 4 propriétés <code>id</code>, <code>firstname</code>, <code>lastname</code> et <code>age</code> je vais me retrouver avec une classe d’environ 100 lignes.</p>
</div>
<div class="paragraph">
<p>Kotlin propose les <code>data class</code> pour lesquelles le compilateur va faire tout ce travail de génération pour vous. Le Pojo speaker se résume au code suivant</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062621.501"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Speaker</span>(<span class="hljs-keyword">val</span> firstname: String,
                   <span class="hljs-keyword">val</span> lastname: String,
                   <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>? = <span class="hljs-literal">null</span>,
                   <span class="hljs-keyword">val</span> id: String = UUID.randomUUID().toString())</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062621.501')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Quand votre classe a un seul constructeur vous pouvez le préciser dans la signature de la classe (comme dans notre classe Speaker). La suppression de tout le code inutile améliore la libilité.</p>
</div>
<div class="paragraph">
<p>Revenons à notre exemple, vous pouvez ainsi écrire</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062622.4568"><span class="hljs-keyword">val</span> s1 = Speaker(<span class="hljs-string">"Chet"</span>, <span class="hljs-string">"Haase"</span>)
<span class="hljs-keyword">val</span> s2 = Speaker(firstname = <span class="hljs-string">"Chet"</span>, lastname = <span class="hljs-string">"Haase"</span>)
<span class="hljs-keyword">val</span> s3 = Speaker(firstname = <span class="hljs-string">"Chet"</span>, lastname = <span class="hljs-string">"Haase"</span>, id = <span class="hljs-string">"123"</span>)

<span class="hljs-keyword">val</span> s4 = s1.copy(age = <span class="hljs-number">999</span>)
<span class="hljs-keyword">val</span> s5 = s1.copy()</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062622.4568')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Le langage propose aussi la surcharge des opérateurs. L’opérateur <code>==</code> est surchargé et fait appel à la méthode <code>equals</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062622.2844">s1 == s5   <span class="hljs-comment">// =&gt; renvoie true car Kotlin fait appel à la méthode equals</span>
s1 === s5  <span class="hljs-comment">// =&gt; renverra faux car === permet de comparer des références</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731447062622.2844')">Copy</button></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_classes_internes">Classes internes</h3>
<div class="paragraph">
<p>Quand vous programmez une application Android en Java, vous utilisez très souvent des classes internes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062623.2136"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorld</span> {

    <span class="hljs-keyword">public</span> String name(){
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Dev-Mind"</span>;
    }

    <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {
        <span class="hljs-keyword">public</span> void hello(){
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"Hello world"</span> + name()); <span class="hljs-comment">// NE COMPILE PAS car la méthode name() n'est pas visible</span>
        }
    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062623.2136')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Les classes internes en Java (<code>inner class</code>) sont non statiques par défaut et vous pouvez donc utiliser les méthodes ou attributs globaux de la classe englobante dans la classe interne. Par exemple dans la classe <code>A</code> je peux utiliser la méthode <code>name()</code> de ma classe englobante <code>HelloWorld</code>.</p>
</div>
<div class="paragraph">
<p>Une classe interne non statique a une référence vers sa classe englobante. Si cette dernière n’est plus utilisée, le garbage collector ne peut pas faire son travail et la supprimer. En effet elle considérée active (utilisée par la classe interne). Dans un serveur d’application, quand nous utilisons des singletons ce concept ne pose pas de problème. Dans le monde Android, sur un device avec des ressources limitées, c’est plus problématique. Surtout si nous utilisons des classes internes dans des objets qui sont très souvent détruits et reconstruits (les activités sont supprimées et recréées après chaque changement de configuration). De nombreux développeurs se font avoir et introduisent des fuites mémoires de cette manière dans leurs applications</p>
</div>
<div class="paragraph">
<p>En Java pour éviter le problème vous devez utiliser des <code>static inner class</code>. En Kotlin quand vous créez une nested class vous n’avez pas accès aux variables et méthodes de la classe (équivalent d’une classe interne statique)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062623.216"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorld</span> {

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">name</span><span class="hljs-params">()</span></span> = <span class="hljs-string">"Dev-Mind"</span>

    <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">hello</span><span class="hljs-params">()</span></span> {
            println(<span class="hljs-string">"Hello world"</span> + name())
        }
    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062623.216')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Vous pouvez tout de même créer l’équivalent d’une inner class en utilisant la syntaxe <code>internal inner class</code>. Une fois encore le langage a pris le parti de simplifier le cas d’utilisation le plus courant.</p>
</div>
</div>
<div class="sect2">
<h3 id="_classes_anonymes">Classes anonymes</h3>
<div class="paragraph">
<p>En Android nous écrivons souvent des classes anonymes. Par exemple à chaque fois que nous écrivons un listener d’événement. Nous avons le même problème de référence entre la classe englobante et la classe anonyme.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062624.6628">button.setOnClickListener{
      <span class="hljs-comment">// votre code</span>
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062624.6628')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Kotlin ne propose pas de solution dans ce cas, mais vous devez garder conscience que vous devrez toujours casser cette référence à la classe englobante quand l’objet sera arrêté ou recyclé.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062624.4111"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStop</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">super</span>.onStop()
    button.setOnClickListener(<span class="hljs-literal">null</span>)
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062624.4111')">Copy</button></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extensions_de_fonction">Extensions de fonction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quand nous programmons nous utilisons de nombreuses librairies externes sur lesquelles nous n’avons pas la main. Prenons un cas d’utilisation. Nous somme l’INSEE et nous devons faire des statistiques par âge</p>
</div>
<div class="paragraph">
<p>Un citoyen est défini par la data class suivante</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062624.281"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Citizen</span>(<span class="hljs-keyword">val</span> inseeNumber: String,
                   <span class="hljs-keyword">val</span> firstname: String,
                   <span class="hljs-keyword">val</span> lastname: String,
                   <span class="hljs-keyword">val</span> sexe: Sexe,
                   <span class="hljs-keyword">val</span> birthdate: LocalDate)</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062624.281')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Pour déterminer l’âge vous pouvez écrire une classe utilitaire</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062624.9827"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAge</span><span class="hljs-params">(date: <span class="hljs-type">LocalDate</span>)</span></span> = LocalDate.now().year - date.year</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062624.9827')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Avec Kotlin vous pouvez aussi étendre la classe <code>LocalDate</code> et créer une nouvelle méthode (extension de fonction) qui vous sera propre et que vous pourrez utiliser dans tout votre projet. Par exemple</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062625.4358"><span class="hljs-function"><span class="hljs-keyword">fun</span> LocalDate.<span class="hljs-title">getAge</span><span class="hljs-params">()</span></span> = LocalDate.now().year - <span class="hljs-keyword">this</span>.year

<span class="hljs-comment">// Ce qui permet d'écrire</span>
LocalDate.parse(<span class="hljs-string">"1977-01-01"</span>).getAge()</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062625.4358')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Mieux au lieu d’exposer une fonction vous pouvez exposer une propriété</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062625.2107"><span class="hljs-keyword">val</span> LocalDate.age
    <span class="hljs-keyword">get</span>() = LocalDate.now().year - <span class="hljs-keyword">this</span>.year

<span class="hljs-comment">// Ce qui permet d'écrire</span>
LocalDate.parse(<span class="hljs-string">"1977-01-01"</span>).age</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062625.2107')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Prenons un autre exemple lié à Android. Très souvent quand nous créons une application, nous surchargeons l’objet <code>Application</code> Android pour créer notre propre instance. Pour éviter les cast à répétition dans les activités vous pouvez écrire</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062625.4363"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DevMindApplication</span> : <span class="hljs-type">Application</span>() {
   <span class="hljs-comment">// code...</span>
}
<span class="hljs-keyword">val</span> AppCompatActivity.devmindApp
    <span class="hljs-keyword">get</span>() = <span class="hljs-keyword">this</span>.application <span class="hljs-keyword">as</span> DevMindApplication</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062625.4363')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Ainsi dans vos activités vous pouvez directement faire appel à votre instance de l’application en utilisant <code>devmindApp</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fonctions_dordre_supérieur">Fonctions d’ordre supérieur</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une fonction d’ordre supérieure est une fonction qui prend une fonction comme argument.</p>
</div>
<div class="paragraph">
<p>Dans ce cas vous n’avez pas besoin de passer une lambda lors de l’appel à la méthode mais vous pouvez ajouter un bloc d’exécution juste après l’appel de la méthode</p>
</div>
<div class="paragraph">
<p>Dit comme ça vous devez être perdu et c’est normal</p>
</div>
<div class="sect2">
<h3 id="_exemple_dans_le_langage">Exemple dans le langage</h3>
<div class="paragraph">
<p>Kotlin s’est servi des fonctions d’ordre supérieur (et des extension) pour simplifier l’utilisation des stream Java</p>
</div>
<div class="listingblock">
<div class="title">Issu de kotlin.collections</div>
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062626.5103"><span class="hljs-keyword">public</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> &lt;T&gt; Iterable&lt;T&gt;.<span class="hljs-title">find</span><span class="hljs-params">(predicate: (<span class="hljs-type">T</span>) <span class="hljs-title class_">-&gt;</span> <span class="hljs-type">Boolean</span>)</span></span>: T? {
    <span class="hljs-keyword">return</span> firstOrNull(predicate)
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062626.5103')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Si nous avons une collection de speakers nous pouvons sélectionner le premier qui a le prénom Guillaume via ce code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062626.0718"><span class="hljs-keyword">val</span> guillaume = speakers.firstOrNull {
    it.firstname == <span class="hljs-string">"Guillaume"</span>  <span class="hljs-comment">// it correpond à l'item en cours</span>
}

<span class="hljs-comment">// Vous auriez pu aussi écrire</span>
<span class="hljs-keyword">val</span> guillaume = speakers.firstOrNull { speaker <span class="hljs-meta">-&gt;</span>
    speaker.firstname == <span class="hljs-string">"Guillaume"</span>
}

<span class="hljs-comment">// Ici la syntaxe Java (où vous passez une lambda provoque une erreur de compilation)</span>
<span class="hljs-keyword">val</span> guillaume = speakers.firstOrNull(speaker <span class="hljs-meta">-&gt;</span> speaker.firstname == <span class="hljs-string">"Guillaume"</span>) <span class="hljs-comment">// ne compile pas</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731447062626.0718')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>En Java, pour rappel vous auriez écrit</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062627.7034"><span class="hljs-keyword">val</span> guillaumeSpeakers = speakers.stream()
                                .filter(s <span class="hljs-meta">-&gt;</span> s.getFirstname().equals(<span class="hljs-string">"Guillaume"</span>))
                                .findFirst()
                                .orElse(<span class="hljs-literal">null</span>);</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062627.7034')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>L’API Stream Java est très agréable à utiliser, mais les collections et les fonctions d’extensions Kotlin le sont encore plus.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ecrire_un_dsl">Ecrire un DSL</h3>
<div class="paragraph">
<p>Kotlin est de plus en plus connu pour la souplesse offerte pour écrire un DSL avec un typage fort. <a href="https://github.com/gradle/kotlin-dsl">Gradle</a> est en train par exemple de remplacer Groovy par Kotlin pour avoir un DSL plus puissant</p>
</div>
<div class="paragraph">
<p>Un exemple</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062628.5024"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cell</span>(<span class="hljs-keyword">val</span> content: String)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Row</span>(<span class="hljs-keyword">val</span> cells: <span class="hljs-symbol">MutableList&lt;Cell&gt; = mutableListOf()) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cell</span><span class="hljs-params">(adder: () <span class="hljs-title class_">-&gt;</span> <span class="hljs-type">Cell</span>)</span></span>: Row {
        cells.add(adder())
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Table</span>(<span class="hljs-keyword">val</span> rows: <span class="hljs-symbol">MutableList&lt;Row&gt; = mutableListOf()) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">row</span><span class="hljs-params">(adder: () <span class="hljs-title class_">-&gt;</span> <span class="hljs-type">Row</span>)</span></span>: Table {
        rows.add(adder())
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    }
}</span></span></code><button class="btn-copy-code" onclick="copyToClipboard('1731447062628.5024')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Dans ma classe <code>Table</code> j’ai ajouté une fonction <code>row</code> (avec une fonction en argument) qui permet d’ajouter une ligne. La même chose a été faite dans la classe <code>Row</code> pour une cellule. Du coup je peux écrire</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062628.5652"><span class="hljs-keyword">val</span> table = Table()
    .row { Row().cell { Cell(<span class="hljs-string">"Test"</span>) }}
    .row { Row().cell { Cell(<span class="hljs-string">"Test2"</span>) }}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062628.5652')">Copy</button></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_android">Android</h3>
<div class="paragraph">
<p>Android bénéficie beaucoup des fonctions d’ordre supérieur et des extensions. Ces fonctionnalités du langage ont permis de considérablement simplfier le langage. Prenons des exemples</p>
</div>
<div class="paragraph">
<p>Ecriture d’un listener d’événement</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062628.875">itemView.setOnClickListener {
     <span class="hljs-comment">// Code du listener directement</span>
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062628.875')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Quand vous devez itérer et enchainer l’appel à plusieurs setters d’un objet</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062628.938">holder.speakerName.text = user.fullname
holder.speakerBio.text = user.descriptionFr
holder.speakerBirthday.text = user.birthday

<span class="hljs-comment">// =&gt; devient</span>
holder.apply {
    speakerName.text = user.fullname
    speakerBio.text = user.descriptionFr
    speakerBirthday.text = user.birthday
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062628.938')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Et il y a des dizaines d’autres exemples.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_coroutines">Coroutines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une coroutine est un bloc de traitement qui permet d’exécuter du code non bloquant en asynchrone. C’est un thread allégé. Vous pouvez lancer plein de couroutines sur un même thread. Vous pouvez aussi démarrer un traitement sur un thread et finir son exécution sur un autre.</p>
</div>
<div class="paragraph">
<p>Commençons par faire un rappel sur le développement Android. Quand une application est lancée, elle est lancée sur un thread principal. On parle de main thread ou UI thread. En effet le rendering, les événements, les appels systèmes sont gérés sur ce thread.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../img/blog/2019/android_thread.png" alt="Android Main Thread">
</div>
</div>
<div class="paragraph">
<p>Si vous lancez un traitement métier plus ou moins long (calcul, récupération de données, accès à une base), vous ne devez pas encombrer ce thread principal pour ne pas bloquer l’utilisateur. Par exemple si vous lancez une requête base de données, tout est figé tant que la réponse n’est pas traitée. Android est d’ailleurs intolérable la dessus. Si votre application bloque le thread principal, le système killera votre application.</p>
</div>
<div class="paragraph">
<p>Sans Kotlin, vous devez lancer tous les traitements plus ou moins longs dans un autre thread. Et quand vous avez un résultat vous devez interagir avec la vue dans le thread principal pour que les données soient actualisées. Niveau code vous devez écrire un bon nombre de ligne pour écrire tout ça.</p>
</div>
<div class="paragraph">
<p>En Kotlin vous pouvez passer par les Coroutines. Dans l’exemple si dessous nous déclarons une activité qui va lancé un accès à la base dans une coroutine et quand le résultat est là nous nous raccrochons au thread principal pour mettre à jour la vue.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731447062629.3882"><span class="hljs-comment">// Votre activité implemente l'interface CoroutineScope</span>
<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyActivity</span> : <span class="hljs-type">AppCompatActivity</span>(), CoroutineScope {

   <span class="hljs-comment">// Si vous lancez votre coroutine vous devez indiquer dans quel thread elle sera lancé. Par défaut un nouveau</span>
   <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> coroutineContext: CoroutineContext
       <span class="hljs-keyword">get</span>() = Dispatchers.Default

   <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
       <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)

       <span class="hljs-comment">// ...</span>

       <span class="hljs-comment">// Lancement de la coroutine</span>
       launch {

          <span class="hljs-comment">// Vous faites un traitement plus ou moins long (appel base de données)</span>
		  <span class="hljs-keyword">val</span> speaker = speakerDao.readOne(speakerUiid)

          <span class="hljs-comment">// Quand vous avez un résultat vous vous rattachez au thread principal</span>
          <span class="hljs-comment">// pour mettre à jour la vue</span>
		  withContext(Dispatchers.Main){
             speaker.apply {
                  speakerLastname.text = speaker.lastname
                  speakerCountry.text = speaker.country
             }
          }
 	   }
   }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731447062629.3882')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Les couroutines simplifient tous les appels acynchrones, ou les appels synchrones pouvant être longs de votre application. Le code est plus restreint, plus lisible mais aussi plus performant car les couroutines sont beaucoup plus légères qu’un thread.</p>
</div>
<div class="sect2">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph">
<p>J’ai essayé de vous montrer dans cet article pourquoi Kotlin est bien plus qu’une alternative à Java pour l’écriture des applications Android.</p>
</div>
<div class="paragraph">
<p>Je vous conseille cette <a href="https://www.youtube.com/watch?v=UhDtYFt64HM">vidéo</a> de Jean Baptiste Nizet qui montre l’intérêt de ce que je viens de dire en livecoding (sauf l’aspect coroutine).</p>
</div>
<div class="paragraph">
<p>Personnellement je pense que le langage Java va petit à petit disparaître sur Android. Si vous voulez utiliser Kotlin en dehors d’Android vous pouvez le faire sans problème. Kotlin fait aussi partie des langages supportés par le framework Spring.</p>
</div>
<div class="paragraph">
<p>Pour plus d’informations sur Kotlin &amp; Android vous pouvez aller sur <a href="https://developer.android.com/kotlin/" class="bare">https://developer.android.com/kotlin/</a></p>
</div>
</div>
</div>
</div></div></div></div></app-asciidoc-viewer><!----><app-footer _ngcontent-ng-c582792440 _nghost-ng-c2660501952 ngh="0"><footer _ngcontent-ng-c2660501952><div _ngcontent-ng-c2660501952 class="dm_footer"><div _ngcontent-ng-c2660501952 class="is-small-screen"><p _ngcontent-ng-c2660501952 id="footer-dm_society"> SARL au capital de <i _ngcontent-ng-c2660501952>5000€</i><br _ngcontent-ng-c2660501952> SIREN : 808 720 759, au RCS de Saint-Etienne<br _ngcontent-ng-c2660501952> All right reserved - ©2024 Guillaume EHRET </p></div><div _ngcontent-ng-c2660501952 class="is-large-screen"><div _ngcontent-ng-c2660501952 class="dm_footer__middle"><div _ngcontent-ng-c2660501952 class="dm_society"> Dev-Mind </div><div _ngcontent-ng-c2660501952>SARL au capital de <i _ngcontent-ng-c2660501952>5000€</i></div><div _ngcontent-ng-c2660501952>SIREN : 808 720 759, au RCS de Saint-Etienne</div><div _ngcontent-ng-c2660501952><small _ngcontent-ng-c2660501952>Mise à jour le 12/11/2024</small></div></div><div _ngcontent-ng-c2660501952 class="dm_footer__right"> All right reserved - ©2024 Guillaume EHRET </div></div></div></footer></app-footer></app-root>

<script src="polyfills-A7MJM4D4.js" type="module"></script><script src="main-7HWWU66L.js" type="module"></script>

<script id="ng-state" type="application/json">{"__nghData__":[{},{"t":{"7":"t6"},"c":{"7":[{"i":"t6","r":1}]}},{"c":{"1":[{"i":"c490234363","r":1}]}}]}</script></body></html>