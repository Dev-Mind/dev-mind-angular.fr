<!DOCTYPE html><html lang="en" data-critters-container><head>
  <meta charset="utf-8">
  <title>Blog</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    body {
      min-height: 100vh;
      max-height: 100vh;
      font-family: "Helvetica", "Arial", "sans-serif";
      padding: 0;
      margin: 0;
    }

    header {
      height: 90px;
      max-height: 90px;
      box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      background-color: white;
      display: -webkit-flex;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
      z-index: 99;
      transition-duration: 0.2s;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-property: max-height, box-shadow;
      position: fixed;
      width: 100%;
      text-align: center;
    }
    header hr {
      width:100%;
      background-color: #424242;
      border-color: #424242;
      display: block;
      border: 0;
      height: 0.5em;
      margin: 0;
    }
    .header-img {
      margin: auto;
      width: 50%;
      padding-top: 0.5em;
      height: 30px;
    }
    .header-img img {
      max-height: 30px !important;
    }
    .header-space {
      min-height: 90px;
    }


    @media screen and (min-width: 901px) {
      header {
        height: 120px;
        max-height: 120px;
      }
      .header-img {
        height: 60px;
      }
      .header-img img {
        max-height: 60px !important;
      }
      .header-space {
        min-height: 120px;
      }
      nav a {
        padding: 6px 24px;
      }
      .nav-home{
        display: block !important;
      }
    }


    nav {
      display: -webkit-flex;
      display: flex;
      margin: auto;
    }

    nav a {
      padding: 0 12px;
      line-height: 28px;
      height: 28px;
      color: #424242;
      margin: auto;
      text-decoration: none;
      text-transform: uppercase;
      font-weight: 600;
      font-size: 13px;
      border-radius: 4px;
    }
    .nav-home{
      display: none;
    }
    nav a > img {
    // height: 20px;
    }

    nav a:hover {
      background-color: #9e9e9e;
    }

    nav .active {
      background-color: rgba(0, 0, 0, 0.14);
    }

    main {
      overflow-x: hidden;
    }

    img, picture {
      max-width: 100%;
      height: auto;
      margin: auto;
    }

    * {
      box-sizing: border-box; /* pour maîtriser width et flex-basis */
    }

    .devmind-section {
      display: block;
      margin: 0 auto;
      max-width: 1600px;
      padding: 60px 40px;
    }

    @media (max-width: 700px) {
      .devmind-section {
        padding: 25px 10px;
      }
    }

    @media (min-width: 701px) and (max-width: 900px) {
      .devmind-section {
        padding: 40px 25px;
      }
    }

    .dm-social {
      min-width: 2em;
      max-width: 2em;
      width: 2em;
      height: 2em;
    }
  </style>
  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setCookieDomain", "*.dev-mind.fr"]);
    _paq.push(["disableCampaignParameters"]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="https://devmind.matomo.cloud/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src='https://cdn.matomo.cloud/devmind.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->
<style>.dm-block--blog{width:100%;background-color:#eceff1;color:#424242;padding:0;margin:0}footer{background-color:#424242}.is-small-screen{display:none}.is-large-screen{display:inherit}@media screen and (max-width: 900px){.is-small-screen{display:inherit}.is-large-screen{display:none}}h1,h2{color:#424242;font-weight:100}h1{font-weight:bolder;font-size:35px;line-height:38px}h2{font-size:25px;line-height:28px}@media (max-width: 700px){h1{font-size:28px;line-height:30px}h2{font-size:22px;line-height:24px}}
</style><link rel="stylesheet" href="styles-WO7TV6DC.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles-WO7TV6DC.css"></noscript><style ng-app-id="ng">.dm_footer[_ngcontent-ng-c2660501952]{color:#eee;display:flex;justify-content:space-between;font-size:14px}.dm_footer[_ngcontent-ng-c2660501952]   .dm_society[_ngcontent-ng-c2660501952]{color:#fff}.dm_footer[_ngcontent-ng-c2660501952]   div[_ngcontent-ng-c2660501952]{margin-right:1em;width:100%}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__middle[_ngcontent-ng-c2660501952]{flex-grow:1}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__right[_ngcontent-ng-c2660501952]{text-align:right}.dm_footer[_ngcontent-ng-c2660501952]   .is-large-screen[_ngcontent-ng-c2660501952]{padding:.7em;margin:.7em 1em}.dm_footer[_ngcontent-ng-c2660501952]   .is-small-screen[_ngcontent-ng-c2660501952]{padding:0;margin:0 1em;font-size:12px}</style><style ng-app-id="ng">h1{margin-top:.5em}.dm-blog--info-date{font-size:smaller;color:#424242;border:1px solid #aaa;border-radius:24px;padding:.5em 1em;margin-right:.5em;display:inline}.blog-keywords{display:flex;margin-bottom:1em}.blog-keywords .dm-blog--keyword-detail{background-color:#ccc;color:#424242;padding:.5em 1em;margin-right:.5em;border-radius:24px;font-size:smaller}.toc{background-color:#ccc;margin-top:1em;border:1px solid #ccc;padding:1em;border-radius:8px}.toc #toctitle{font-weight:700;margin-bottom:.5em}img{max-width:100%;height:auto}.imageblock>.content{display:flex;justify-content:center;align-items:center}.highlight{display:block;overflow-x:auto;background:#f3f3f3;color:#444;padding:1.5em;box-shadow:0 8px 16px #00000026;border-radius:8px}code.hljs{padding:3px 5px}.hljs-comment{color:#697070}.hljs-punctuation,.hljs-tag{color:#444a}.hljs-tag .hljs-attr,.hljs-tag .hljs-name{color:#444}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-link,.hljs-operator,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#ab5656}.hljs-literal{color:#695}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta .hljs-string{color:#38a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.language-kotlin:before{display:block;float:right;content:"kotlin";font-weight:700;text-transform:uppercase}.language-typescript:before{display:block;float:right;content:"typescript";font-weight:700;text-transform:uppercase}.language-java:before{display:block;float:right;content:"java";font-weight:700;text-transform:uppercase}.language-javascript:before{display:block;float:right;content:"javascript";font-weight:700;text-transform:uppercase}.language-shell:before{display:block;float:right;content:"shell";font-weight:700;text-transform:uppercase}.language-yaml:before{display:block;float:right;content:"yaml";font-weight:700;text-transform:uppercase}.language-json:before{display:block;float:right;content:"json";font-weight:700;text-transform:uppercase}.language-xml:before{display:block;float:right;content:"xml";font-weight:700;text-transform:uppercase}.language-html:before{display:block;float:right;content:"html";font-weight:700;text-transform:uppercase}.language-css:before{display:block;float:right;content:"css";font-weight:700;text-transform:uppercase}.language-scss:before{display:block;float:right;content:"scss";font-weight:700;text-transform:uppercase}
</style></head>
<body><!--nghm-->
  <app-root _nghost-ng-c582792440 ng-version="17.2.1" ngh="2" ng-server-context="ssg"><app-header _ngcontent-ng-c582792440 _nghost-ng-c2882497807 ngh="0"><header _ngcontent-ng-c2882497807><div _ngcontent-ng-c2882497807 class="header-img"><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" href="/"><img _ngcontent-ng-c2882497807 src="img/logo/logo_long.svg" alt="Dev-Mind" title="Dev-Mind"></a></div><nav _ngcontent-ng-c2882497807><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" class="nav-home" href="/"><img _ngcontent-ng-c2882497807 src="/img/ic_home_white_24px.svg" rel="start" alt="Accueil"></a><a _ngcontent-ng-c2882497807 routerlink="/formations.html" aria-label="Formations" class href="/formations.html"> Formations</a><a _ngcontent-ng-c2882497807 routerlink="/blog.html" aria-label="Blog" class="active" href="/blog.html">Blog</a><a _ngcontent-ng-c2882497807 routerlink="/experience.html" aria-label="Experience" class href="/experience.html"> Expérience</a></nav><hr _ngcontent-ng-c2882497807></header><div _ngcontent-ng-c2882497807 class="header-space"></div></app-header><router-outlet _ngcontent-ng-c582792440></router-outlet><app-asciidoc-viewer ngh="1"><div class="dm-block--blog"><div class="devmind-section"><h1><!--ngetn--></h1><div class="blog-keywords"><div class="dm-blog--info-date">12/01/2017</div><div class="dm-blog--keyword-detail">Java</div><div class="dm-blog--keyword-detail">Gradle</div><div class="dm-blog--keyword-detail">Kotlin</div><!---->&nbsp; </div><div class="preview"><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>En mai 2016 Gradle annonçait qu’il était maintenant possible d’écrire des scripts (build.gradle) et des plugins en Kotlin. Ce choix pouvait paraître étonnant alors que Gradle avait depuis ces débuts beaucoup investi sur le langage Groovy.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../img/blog/2017/ecrire_ses_scripts_gradle_en_kotlin_01.png" alt="Gradle Kotlin">
</div>
</div>
<div class="paragraph">
<p>Le langage Kotlin à l’avantage d’être statique et typé et son utilisation permet de considérablement enrichir l’expérience des développeurs dans les IDE</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Auto-complétion et aide contextuel</p>
</li>
<li>
<p>Navigation à la source</p>
</li>
<li>
<p>Refactoring</p>
</li>
<li>
<p>…​</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Je vous conseille de lire le très bon article de blog de Cédric Champeau (ancien de la core team Groovy embauché par Gradle) qui explique beaucoup mieux que moi les avantages.</p>
</div>
<div class="paragraph">
<p>Ce qui m’intéresse dans cet article c’est plutôt vous montrer comment paramétrer un cas concret. Je vous conseille pour cela d’utiliser la dernière version de Gradle (3.3). Le repo Github contenant les sources du projet “Gradle Script Kotlin” comprend plusieurs exemples.</p>
</div>
<div class="paragraph">
<p>Dans cet article je me base sur le script de construction build.gradle.kts du site Mix-IT 2017. Ce script permet de construire une application Spring Boot écrite en Kotlin et ce qui est plutôt sympa c’est que Kotlin est du coup utilisé sur toute la chaîne. Vous pouvez comparer ce script avec celui utilisé dans l’ancienne version du site.</p>
</div>
<div class="paragraph">
<p>Mon objectif est d’essayer de vous montrer les différences entre un script Groovy et Kotlin en essayant de paramétrer le plugin gradle-node-plugin. Ce plugin permet de piloter Gulp (appli node.js) via Gradle pour avoir une seule manière de construire notre application Java ou Kotlin. A noter que ce plugin permet l’utilisation de npm ou yarn pour gérer vos dépendances JavaScript. Dans notre cas nous avons opté pour yarn.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_paramétrage_du_build">Paramétrage du build</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dans un script Gradle nous avons une partie utilisée pour paramétrer le build lui même. En Groovy on écrit</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin">buildscript {
    ext {
        nodePluginVersion = <span class="hljs-string">'1.0.1'</span>
    }
    repositories {
        mavenCentral()
        jcenter()
        maven {
            url <span class="hljs-string">"https://plugins.gradle.org/m2/"</span>
        }
    }
    dependencies {
        classpath <span class="hljs-string">"com.moowork.gradle:gradle-node-plugin:${nodePluginVersion}"</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>En Kotlin</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy">buildscript {
    ext {
        nodePluginVersion = <span class="hljs-string">'1.0.1'</span>
    }
    repositories {
        mavenCentral()
        jcenter()
        maven {
            url <span class="hljs-string">"https://plugins.gradle.org/m2/"</span>
        }
    }
    dependencies {
        classpath <span class="hljs-string">"com.moowork.gradle:gradle-node-plugin:${nodePluginVersion}"</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Vous me direz jusque là pas beaucoup de changement. Déclarons maintenant les plugins utilisés par notre projet</p>
</div>
<div class="paragraph">
<p>En Groovy</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy">apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">'idea'</span>
apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">'com.moowork.node'</span>
apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">'com.moowork.gulp'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En Kotlin</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin">apply {
    plugin(<span class="hljs-string">"idea"</span>)
    plugin(<span class="hljs-string">"kotlin"</span>)
    plugin(<span class="hljs-string">"kotlin-noarg"</span>)
    plugin(<span class="hljs-string">"com.moowork.node"</span>)
    plugin(<span class="hljs-string">"com.moowork.gulp"</span>)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_du_plugin_gradle_node_plugin">Configuration du plugin gradle-node-plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les plugins (c’est le cas de gradle-gulp-plugin) peuvent avoir une partie configuration (les points d’extensions)</p>
</div>
<div class="paragraph">
<p>En Groovy</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy">node {
    version = <span class="hljs-string">'6.9.2'</span>
    download = <span class="hljs-literal">true</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>En Kotlin</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin"><span class="hljs-keyword">import</span> com.moowork.gradle.node.NodeExtension

configure&amp;lt;NodeExtension&amp;gt; {
    version = <span class="hljs-string">"6.9.2"</span>
    download = <span class="hljs-literal">true</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notez que vous devez importer le point d’extension pour être capable de surcharger les paramètres par défaut d’un plugin. Ceci demande de connaître un peu le fonctionnement de Gradle et de ces plugins (voir mon article ou encore mieux la doc :-) ).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_définir_une_tâche">Définir une tâche</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Regardons maintenant comment configurer une tâche et l’intégrer dans le cycle de vie Gradle</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy">task gulpBuild(<span class="hljs-attr">type:</span> GulpTask, <span class="hljs-attr">dependsOn:</span> yarnInstall) {
  inputs.dir <span class="hljs-string">'src/main/sass'</span>  inputs.files(npmInstall.outputs)
  outputs.dir <span class="hljs-string">"src/main/static/css"</span>  args = [<span class="hljs-string">"default"</span>]
}

processResources {
  dependsOn gulpBuild
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>En Kotlin</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin"><span class="hljs-keyword">import</span> com.moowork.gradle.gulp.GulpTask
<span class="hljs-keyword">import</span> com.moowork.gradle.node.yarn.YarnInstallTask

task&amp;lt;GulpTask&amp;gt;(<span class="hljs-string">"gulpBuild"</span>) {
  dependsOn(YarnInstallTask.NAME)
  inputs.dir(<span class="hljs-string">"src/main/sass"</span>)
  inputs.dir(<span class="hljs-string">"build/.tmp"</span>)
  outputs.dir(<span class="hljs-string">"src/main/static/css"</span>)
  args = listOf(<span class="hljs-string">"default"</span>)
}

tasks.getByName(<span class="hljs-string">"processResources"</span>).dependsOn(<span class="hljs-string">"gulpBuild"</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Je n’ai exposé ici que les cas les plus courants utilisés dans Gradle. Vous pouvez toujours programmer vos tâches en Groovy ou Kotlin dans vos scripts. Pour plus d’info je vous réoriente vers les exemples officiels et la page Stackoverflow (qui n’est pas encore très riche sur le sujet).</p>
</div>
<div class="paragraph">
<p>Nous verrons dans les mois qui viennent si Kotlin prend la main sur Groovy dans les scripts de configuration Gradle. Pour le moment le manque de documentation sur Gradle Script Kotlin est vraiment problématique.</p>
</div>
</div>
</div></div></div></div></app-asciidoc-viewer><!----><app-footer _ngcontent-ng-c582792440 _nghost-ng-c2660501952 ngh="0"><footer _ngcontent-ng-c2660501952><div _ngcontent-ng-c2660501952 class="dm_footer"><div _ngcontent-ng-c2660501952 class="is-small-screen"><p _ngcontent-ng-c2660501952 id="footer-dm_society"> SARL au capital de <i _ngcontent-ng-c2660501952>5000€</i><br _ngcontent-ng-c2660501952> SIREN : 808 720 759, au RCS de Saint-Etienne<br _ngcontent-ng-c2660501952> All right reserved - ©2024 Guillaume EHRET </p></div><div _ngcontent-ng-c2660501952 class="is-large-screen"><div _ngcontent-ng-c2660501952 class="dm_footer__middle"><div _ngcontent-ng-c2660501952 class="dm_society"> Dev-Mind </div><div _ngcontent-ng-c2660501952>SARL au capital de <i _ngcontent-ng-c2660501952>5000€</i></div><div _ngcontent-ng-c2660501952>SIREN : 808 720 759, au RCS de Saint-Etienne</div><div _ngcontent-ng-c2660501952><small _ngcontent-ng-c2660501952>Mise à jour le 14/05/2024</small></div></div><div _ngcontent-ng-c2660501952 class="dm_footer__right"> All right reserved - ©2024 Guillaume EHRET </div></div></div></footer></app-footer></app-root>

<script src="polyfills-RX4V3J3S.js" type="module"></script><script src="main-27LCYEA2.js" type="module"></script>

<script id="ng-state" type="application/json">{"__nghData__":[{},{"t":{"7":"t1"},"c":{"7":[{"i":"t1","r":1,"x":3}]}},{"c":{"1":[{"i":"c933498719","r":1}]}}]}</script></body></html>