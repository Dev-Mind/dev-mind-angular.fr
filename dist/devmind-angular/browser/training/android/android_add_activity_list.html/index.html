<!DOCTYPE html><html lang="en" data-critters-container><head>
  <meta charset="utf-8">
  <title>Training</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    body {
      min-height: 100vh;
      max-height: 100vh;
      font-family: "Helvetica", "Arial", "sans-serif";
      padding: 0;
      margin: 0;
    }

    header {
      height: 90px;
      max-height: 90px;
      box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      background-color: white;
      display: -webkit-flex;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
      z-index: 99;
      transition-duration: 0.2s;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-property: max-height, box-shadow;
      position: fixed;
      width: 100%;
      text-align: center;
    }
    header hr {
      width:100%;
      background-color: #424242;
      border-color: #424242;
      display: block;
      border: 0;
      height: 0.5em;
      margin: 0;
    }
    .header-img {
      margin: auto;
      width: 50%;
      padding-top: 0.5em;
      height: 30px;
    }
    .header-img img {
      max-height: 30px !important;
    }
    .header-space {
      min-height: 90px;
    }


    @media screen and (min-width: 901px) {
      header {
        height: 120px;
        max-height: 120px;
      }
      .header-img {
        height: 60px;
      }
      .header-img img {
        max-height: 60px !important;
      }
      .header-space {
        min-height: 120px;
      }
      nav a {
        padding: 6px 24px;
      }
      .nav-home{
        display: block !important;
      }
    }


    nav {
      display: -webkit-flex;
      display: flex;
      margin: auto;
    }

    nav a {
      padding: 0 12px;
      line-height: 28px;
      height: 28px;
      color: #424242;
      margin: auto;
      text-decoration: none;
      text-transform: uppercase;
      font-weight: 600;
      font-size: 13px;
      border-radius: 4px;
    }
    .nav-home{
      display: none;
    }
    nav a > img {
    // height: 20px;
    }

    nav a:hover {
      background-color: #9e9e9e;
    }

    nav .active {
      background-color: rgba(0, 0, 0, 0.14);
    }

    main {
      overflow-x: hidden;
    }

    img, picture {
      max-width: 100%;
      height: auto;
      margin: auto;
    }

    * {
      box-sizing: border-box; /* pour maîtriser width et flex-basis */
    }

    .devmind-section {
      display: block;
      margin: 0 auto;
      max-width: 1600px;
      padding: 60px 40px;
    }

    @media (max-width: 700px) {
      .devmind-section {
        padding: 25px 10px;
      }
    }

    @media (min-width: 701px) and (max-width: 900px) {
      .devmind-section {
        padding: 40px 25px;
      }
    }

    .dm-social {
      min-width: 2em;
      max-width: 2em;
      width: 2em;
      height: 2em;
    }
  </style>
  <script>
    function copyToClipboard(id) {
      const text = document.getElementById(id).innerText
        .replaceAll('~$', '')
        .replaceAll('(1)', '')
        .replaceAll('(2)', '')
        .replaceAll('(3)', '')
        .replaceAll('(4)', '')
        .replaceAll('(5)', '')
        .replaceAll('(6)', '')
        .replaceAll('(7)', '')
        .replaceAll('(8)', '')
        .replaceAll('(9)', '')
        .replaceAll('(10)', '')
      ;
      navigator.clipboard.writeText(text.substring(0, text.length));
    }
  </script>
<style>code[class*=language-]{color:#555;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}.imageblock{text-align:center}.toc{background:#f0f8ff;padding:1em}h1,h2{font-weight:100}h1{font-size:35px;line-height:38px}.dm-block--blog{width:100%;background-color:#eceff1;color:#424242;padding:0;margin:0}.dm-block--blog a,.dm-block--blog a:hover,.dm-block--blog a:visited{font-weight:700;color:#424242;text-decoration:none;cursor:pointer}.dm-block--blog .link{display:block}.btn-copy-code{background-color:#fff;border:2px solid white;border-radius:24px;color:#424242!important;margin:1em .5em auto auto;font-weight:700;font-size:16px;display:block;cursor:pointer;width:auto;text-align:center;box-shadow:0 4px 5px #00000024,0 1px 10px #0000001f,0 2px 4px -1px #0003;padding:4px;font-size:small}.btn-copy-code:hover{background-color:#424242;border:2px solid #424242;color:#fff!important;padding:.5em 1em}footer{background-color:#424242}.is-small-screen{display:none}.is-large-screen{display:inherit}@media screen and (max-width: 900px){.is-small-screen{display:inherit}.is-large-screen{display:none}}h1,h2{color:#424242;font-weight:100}h1{font-weight:bolder;font-size:35px;line-height:38px}h2{font-size:25px;line-height:28px}@media (max-width: 700px){h1{font-size:28px;line-height:30px}h2{font-size:22px;line-height:24px}}
</style><link rel="stylesheet" href="styles-2E537E2B.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles-2E537E2B.css"></noscript><style ng-app-id="ng">.dm_footer[_ngcontent-ng-c2660501952]{color:#eee;display:flex;justify-content:space-between;font-size:14px}.dm_footer[_ngcontent-ng-c2660501952]   .dm_society[_ngcontent-ng-c2660501952]{color:#fff}.dm_footer[_ngcontent-ng-c2660501952]   div[_ngcontent-ng-c2660501952]{margin-right:1em;width:100%}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__middle[_ngcontent-ng-c2660501952]{flex-grow:1}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__right[_ngcontent-ng-c2660501952]{text-align:right}.dm_footer[_ngcontent-ng-c2660501952]   .is-large-screen[_ngcontent-ng-c2660501952]{padding:.7em;margin:.7em 1em}.dm_footer[_ngcontent-ng-c2660501952]   .is-small-screen[_ngcontent-ng-c2660501952]{padding:0;margin:0 1em;font-size:12px}</style><style ng-app-id="ng">h1{margin-top:.5em}.dm-blog--info-date{font-size:smaller;color:#424242;border:1px solid #aaa;border-radius:24px;padding:.5em 1em;margin-right:.5em;display:inline}.blog-keywords{display:flex;margin-bottom:1em}.blog-keywords .dm-blog--keyword-detail{background-color:#ccc;color:#424242;padding:.5em 1em;margin-right:.5em;border-radius:24px;font-size:smaller}.toc{background-color:#ccc;margin-top:1em;border:1px solid #ccc;padding:1em;border-radius:8px}.toc #toctitle{font-weight:700;margin-bottom:.5em}img{max-width:100%;height:auto}.imageblock>.content{display:flex;justify-content:center;align-items:center}.highlight{display:block;overflow-x:auto;background:#f3f3f3;color:#444;padding:1.5em;box-shadow:0 8px 16px #00000026;border-radius:8px}code.hljs{padding:3px 5px}.hljs-comment{color:#697070}.hljs-punctuation,.hljs-tag{color:#444a}.hljs-tag .hljs-attr,.hljs-tag .hljs-name{color:#444}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-link,.hljs-operator,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#ab5656}.hljs-literal{color:#695}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta .hljs-string{color:#38a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.language-kotlin:before{display:block;float:right;content:"kotlin";font-weight:700;text-transform:uppercase}.language-typescript:before{display:block;float:right;content:"typescript";font-weight:700;text-transform:uppercase}.language-java:before{display:block;float:right;content:"java";font-weight:700;text-transform:uppercase}.language-javascript:before{display:block;float:right;content:"javascript";font-weight:700;text-transform:uppercase}.language-shell:before{display:block;float:right;content:"shell";font-weight:700;text-transform:uppercase}.language-yaml:before{display:block;float:right;content:"yaml";font-weight:700;text-transform:uppercase}.language-json:before{display:block;float:right;content:"json";font-weight:700;text-transform:uppercase}.language-xml:before{display:block;float:right;content:"xml";font-weight:700;text-transform:uppercase}.language-html:before{display:block;float:right;content:"html";font-weight:700;text-transform:uppercase}.language-css:before{display:block;float:right;content:"css";font-weight:700;text-transform:uppercase}.language-scss:before{display:block;float:right;content:"scss";font-weight:700;text-transform:uppercase}
</style></head>
<body><!--nghm-->
  <app-root _nghost-ng-c582792440 ng-version="18.0.0" ngh="2" ng-server-context="ssg"><app-header _ngcontent-ng-c582792440 _nghost-ng-c2882497807 ngh="0"><header _ngcontent-ng-c2882497807><div _ngcontent-ng-c2882497807 class="header-img"><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" href="/"><img _ngcontent-ng-c2882497807 src="img/logo/logo_long.svg" alt="Dev-Mind" title="Dev-Mind"></a></div><nav _ngcontent-ng-c2882497807><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" class="nav-home" href="/"><img _ngcontent-ng-c2882497807 src="/img/ic_home_white_24px.svg" rel="start" alt="Accueil"></a><a _ngcontent-ng-c2882497807 routerlink="/formations.html" aria-label="Formations" class="active" href="/formations.html"> Formations</a><a _ngcontent-ng-c2882497807 routerlink="/blog.html" aria-label="Blog" class href="/blog.html">Blog</a><a _ngcontent-ng-c2882497807 routerlink="/experience.html" aria-label="Experience" class href="/experience.html"> Expérience</a></nav><hr _ngcontent-ng-c2882497807></header><div _ngcontent-ng-c2882497807 class="header-space"></div></app-header><router-outlet _ngcontent-ng-c582792440></router-outlet><app-asciidoc-viewer ngh="1"><div class="dm-block--blog"><div class="devmind-section"><h1><!--ngetn--></h1><div class="blog-keywords"><div class="dm-blog--info-date">10/10/2023</div><div class="dm-blog--keyword-detail">Android</div><!---->&nbsp; </div><div class="preview"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a class="link" fragment="#_recyclerview">RecyclerView</a></li>
<li><a class="link" fragment="#_flask_display_the_room_list"><img src="/img/ic_flask.svg" style="width: 1em"> : Display the room list</a>
<ul class="sectlevel2">
<li><a class="link" fragment="#_update_room_list_activity">Update room list activity</a></li>
<li><a class="link" fragment="#_create_a_layout_for_a_list_item">Create a layout for a list item</a></li>
<li><a class="link" fragment="#_create_an_adapter_class">Create an adapter class</a></li>
<li><a class="link" fragment="#_update_roomsactivity_class">Update RoomsActivity class</a></li>
</ul>
</li>
<li><a class="link" fragment="#_flask_open_a_list_item"><img src="/img/ic_flask.svg" style="width: 1em"> : Open a list item</a>
<ul class="sectlevel2">
<li><a class="link" fragment="#_declare_an_interface_to_define_a_contract">Declare an interface to define a contract</a></li>
<li><a class="link" fragment="#_update_roomsactivity">Update RoomsActivity</a></li>
<li><a class="link" fragment="#_update_the_let_adapter">Update the let adapter</a></li>
</ul>
</li>
<li><a class="link" fragment="#_more">More…​</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this lesson, you will learn how to populate a list of room in our empty rooms screen.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../img/training/android/android-activity-list.png" alt="Create an activity list" width="800">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recyclerview">RecyclerView</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you want to create a list view you should use a <strong>RecyclerView</strong> widget. This widget is able to manage a large data sets and scrool between elements.</p>
</div>
<div class="paragraph">
<p>The overall container for your user interface is a <strong>RecyclerView</strong> object that you add to your layout. The RecyclerView fills itself with views provided by a layout manager that you provide. The views in the list (used to display items) are represented by view holder objects. Each view holder is in charge of displaying a single item with a view.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../img/training/android/android-listview.png" alt="Android RecyclerView">
</div>
</div>
<div class="paragraph">
<p>For example, if your list shows music collection, each view holder might represent a single album. The RecyclerView creates only as many view holders as are needed to display the on-screen portion of the dynamic content, plus a few extra. As the user scrolls through the list, the RecyclerView takes the off-screen views and rebinds them to the data which is scrolling onto the screen.</p>
</div>
<div class="paragraph">
<p>The view holder objects are managed by an adapter (create by extending <strong>RecyclerView.Adapter</strong>). This adapter creates view holders as needed. The adapter also binds the view holders to their data. It does this by assigning the view holder to a position.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1722604315834.622"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomsAdapter</span> : <span class="hljs-type">RecyclerView.Adapter&lt;RoomsAdapter.RoomsViewHolder&gt;</span>() { <span class="hljs-comment">// (1)</span>

    <span class="hljs-keyword">inner</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomsViewHolder</span>(view: View) : RecyclerView.ViewHolder(view) { <span class="hljs-comment">// (2)</span>
        <span class="hljs-keyword">val</span> name: TextView = view.findViewById(R.id.txt_room_name)
        <span class="hljs-keyword">val</span> currentTemperature: TextView = view.findViewById(R.id.txt_current_temperature)
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> items = <span class="hljs-symbol">mutableListOf@</span><span class="hljs-symbol">LTRoomDto@</span>GT() <span class="hljs-comment">// (3)</span>

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setItems</span><span class="hljs-params">(rooms: <span class="hljs-type">List</span>@<span class="hljs-type">LTRoomDto</span>@<span class="hljs-type">GT</span>)</span></span> {  <span class="hljs-comment">// (4)</span>
        items.clear()
        items.addAll(rooms)
        notifyDataSetChanged()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getItemCount</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> = items.size <span class="hljs-comment">// (5)</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateViewHolder</span><span class="hljs-params">(parent: <span class="hljs-type">ViewGroup</span>, viewType: <span class="hljs-type">Int</span>)</span></span>: RoomsViewHolder { <span class="hljs-comment">// (6)</span>
        <span class="hljs-keyword">val</span> view = LayoutInflater.from(parent.context)
            .inflate(R.layout.activity_rooms_item, parent, <span class="hljs-literal">false</span>)
        <span class="hljs-keyword">return</span> RoomsViewHolder(view)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBindViewHolder</span><span class="hljs-params">(holder: <span class="hljs-type">RoomsViewHolder</span>, position: <span class="hljs-type">Int</span>)</span></span> {  <span class="hljs-comment">// (7)</span>
        <span class="hljs-keyword">val</span> roomDto = items[position]
        holder.apply {
            name.text = roomDto.name
            currentTemperature.text = roomDto.currentTemperature?.toString() ?: <span class="hljs-string">"?"</span>
        }
    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1722604315834.622')">Copy</button></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>(1) an adapter must implement <strong>RecyclerView.Adapter</strong> wich manage a <strong>RecyclerView.ViewHolder</strong></p>
</li>
<li>
<p>(2) we create a <strong>RoomsViewHolder</strong> which is able to hold fields defined in layout <strong>activity_rooms_item.xml</strong>. When you scroll through the list view, system does not recreate these fields. It will update the values via method (7)</p>
</li>
<li>
<p>(3) adapter has a mutable list to store elements to display</p>
</li>
<li>
<p>(4) method used to update the list content. This method will be called when data will be ready</p>
</li>
<li>
<p>(5) <strong>RecyclerView.Adapter</strong> abstract class asks you to implement a first method that returns the number of records</p>
</li>
<li>
<p>(6) <strong>RecyclerView.Adapter</strong> abstract class asks you to implement a second method used to initialize a <strong>ViewHolder</strong></p>
<div class="ulist">
<ul>
<li>
<p>we inflate <strong>activity_rooms_item.xml</strong> layout</p>
</li>
<li>
<p>we send it to  <strong>ViewHolder</strong> constructor</p>
</li>
</ul>
</div>
</li>
<li>
<p>(7) <strong>RecyclerView.Adapter</strong> abstract class asks you to implement a last method to define what to do when position in the list changes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flask_display_the_room_list"><img src="/img/ic_flask.svg" style="width: 1em"> : Display the room list</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_update_room_list_activity">Update room list activity</h3>
<div class="paragraph">
<p>We will update the empty component created in <a href="android-add-menu.html#_create_a_new_activity">last session</a> called room list. We will add a Recycler view inside</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open <strong>res &gt; layout &gt; activity_rooms.xml</strong> and delete the TextView</p>
</li>
<li>
<p>In <strong>Containers palette</strong> select a <strong>RecyclerView</strong> widget and drag into your layout below your welcome message.</p>
</li>
<li>
<p>This <strong>RecyclerView</strong> widget should have these properties</p>
<div class="ulist">
<ul>
<li>
<p><strong>id</strong> : <em>list_rooms</em></p>
</li>
<li>
<p><strong>margins</strong> : <em>16dp</em> Apply a top, right and left margin</p>
</li>
<li>
<p><strong>layout_width</strong> : widget should take all the width (0dp or match_parent)</p>
</li>
<li>
<p><strong>layout_height</strong> : widget should take all the height (0dp or match_parent)</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_layout_for_a_list_item">Create a layout for a list item</h3>
<div class="paragraph">
<p>Each line in the <code>RecyclerView</code> is displayed in its own layout.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select <strong>res &gt; layout</strong> right click and choose <strong>New &gt; Layout resource file</strong></p>
</li>
<li>
<p>Name your future layout <strong>activity_rooms_item.xml</strong></p>
</li>
<li>
<p>In <strong>Component Tree</strong> panel (below Palette panel) select ConstraintLayout (the main viewgroup) <strong>and update property</strong> <strong>layout_height</strong> to <em>wrap_content</em>. If you don’t, the view will always fill all the available height on its parent (our recyclerview) and you will still only see one element in your list and others will be hidden.</p>
</li>
<li>
<p>Add 3 <strong>Textviews</strong> : one for the room name, one for the current temperature label and a last one for the current temperature value</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should have this rendering</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../img/training/android/list/android-room-item.png" alt="Android item layout">
</div>
</div>
<div class="paragraph">
<p>You can use these properties on your TextFields</p>
</div>
<div class="paragraph">
<p><strong>Room name</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>id</strong> : <em>txt_room_name</em></p>
</li>
<li>
<p><strong>marginStart</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>marginTop</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>marginEnd</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>layout_width</strong> : <em>0dp</em> to have the name on all the width</p>
</li>
<li>
<p><strong>textStyle</strong> : <em>bold</em></p>
</li>
<li>
<p><strong>textAppearance</strong> : <em>@style/TextAppearance.AppCompat.Large</em></p>
</li>
<li>
<p><strong>text</strong> : <em>empty</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Current temperature label</strong> put this element under the room name on the left</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>id</strong> : <em>txt_current_temperature_label</em></p>
</li>
<li>
<p><strong>marginStart</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>marginBottom</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>marginTop</strong> : <em>8dp</em></p>
</li>
<li>
<p><strong>marginEnd</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>layout_width</strong> : <em>wrap_content</em></p>
<div class="ulist">
<ul>
<li>
<p><strong>text</strong> : <em>@string/room_current_temperature</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Current temperature value</strong> put this element under the room name on the right of the label</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A last TextView to display window room</p>
<div class="ulist">
<ul>
<li>
<p><strong>id</strong> : <em>txt_current_temperature_value</em></p>
</li>
<li>
<p><strong>marginStart</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>marginTop</strong> : <em>8dp</em></p>
</li>
<li>
<p><strong>marginEnd</strong> : <em>16dp</em></p>
</li>
<li>
<p><strong>layout_width</strong> : <em>0dp</em></p>
</li>
<li>
<p><strong>text</strong> : <em>empty</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_create_an_adapter_class">Create an adapter class</h3>
<div class="paragraph">
<p>As we have seen in <a href="android-add-activity-list.html#_recyclerview">previous chapter</a>, an adapter manages the view holder objects. The adapter also binds the view holders to their data. It does this by assigning the view holder to a position.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new package <em>com.automacorp.adapter</em></p>
</li>
<li>
<p>Create inside a new class called <strong>RoomsAdapter</strong></p>
</li>
<li>
<p>You can copy the example done higher in the first chapter</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_update_roomsactivity_class">Update RoomsActivity class</h3>
<div class="paragraph">
<p>We need to initialize the recycler view</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1722604315835.0073"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomsActivity</span> : <span class="hljs-type">BasicActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_rooms)

        <span class="hljs-keyword">val</span> roomsAdapter = RoomAdapdter()

        <span class="hljs-symbol">findViewById@</span><span class="hljs-symbol">LTRecyclerView@</span>GT(R.id.list_rooms).also { recyclerView <span class="hljs-meta">-&gt;</span> <span class="hljs-comment">// (1)</span>
            recyclerView.layoutManager = LinearLayoutManager(<span class="hljs-keyword">this</span>) <span class="hljs-comment">// (2)</span>
            recyclerView.addItemDecoration(DividerItemDecoration(<span class="hljs-keyword">this</span>, DividerItemDecoration.VERTICAL)) <span class="hljs-comment">// (3)</span>
            recyclerView.setHasFixedSize(<span class="hljs-literal">true</span>) <span class="hljs-comment">// (4)</span>
            recyclerView.adapter = roomsAdapter <span class="hljs-comment">// (5)</span>
        }

        roomsAdapter.setItems(RoomService.ROOMS)  <span class="hljs-comment">// (6)</span>
    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1722604315835.0073')">Copy</button></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>(1) we find the recycler view defined in layout by its id <code>list_rooms</code></p>
</li>
<li>
<p>(2) we have to define the default layout manager (the object which will be used to display a layout on each line)</p>
</li>
<li>
<p>(3) you can add a line between each line</p>
</li>
<li>
<p>(4) this indicator help the RecyclerView to optimize the display when all lines have the same size</p>
</li>
<li>
<p>(5) the adapter is linked to the RecyclerView</p>
</li>
<li>
<p>(6) data are sent to the adapter to display the lines</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can now launch your app. You should be able to see the default rooms</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../../img/training/android/list/android-room-list.png" alt="Android list" width="300">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flask_open_a_list_item"><img src="/img/ic_flask.svg" style="width: 1em"> : Open a list item</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At this step we have a list of rooms. We would now open the detail of a room when the user clicks on an item in the list.</p>
</div>
<div class="sect2">
<h3 id="_declare_an_interface_to_define_a_contract">Declare an interface to define a contract</h3>
<div class="paragraph">
<p>You need to define an interface which defines a method called when a user clicks on an element</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1722604315835.824"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">OnRoomClickListener</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectRoom</span><span class="hljs-params">(id: <span class="hljs-type">Long</span>)</span></span>
}</code><button class="btn-copy-code" onclick="copyToClipboard('1722604315835.824')">Copy</button></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>RoomsActivity</strong> will implement this interface and it will able to call <code>Roomctivity</code> and send it the given id</p>
</li>
<li>
<p><strong>RoomsAdapter</strong> will receive an instance of this interface (ie RoomsActivity) and call the method when a user will click on a line</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_update_roomsactivity">Update RoomsActivity</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1722604315836.1123">We will implement the contract and create an Intent to <span class="hljs-keyword">open</span> a `RoomActivity`</code><button class="btn-copy-code" onclick="copyToClipboard('1722604315836.1123')">Copy</button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>class RoomsActivity : BasicActivity(), OnRoomClickListener {
   //...

   override fun selectRoom(id: Long) {
        val intent = Intent(this, RoomActivity::class.java).putExtra(MainActivity.ROOM_ID_PARAM, id)
        startActivity(intent)
    }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_update_the_let_adapter">Update the let adapter</h3>
<div class="paragraph">
<p>An instance of our interface <code>OnRoomClickListener</code> is sent in the adapter constructor, and we can call the method in a Click Event listener. In Android, you can interact with different all user events, each object has its own events…​.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1722604315836.0596"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomsAdapter</span>(<span class="hljs-keyword">val</span> listener: OnRoomClickListener): RecyclerView.<span class="hljs-symbol">Adapter@</span>LTRoomsAdapter.<span class="hljs-symbol">RoomsViewHolder@</span>GT() {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBindViewHolder</span><span class="hljs-params">(holder: <span class="hljs-type">RoomsViewHolder</span>, position: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-keyword">val</span> roomDto = items[position]
        holder.apply {
            name.text = roomDto.name
            currentTemperature.text = roomDto.currentTemperature?.toString() ?: <span class="hljs-string">"?"</span>
            itemView.setOnClickListener { listener.selectRoom(roomDto.id) } <span class="hljs-comment">// (1)</span>
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewRecycled</span><span class="hljs-params">(holder: <span class="hljs-type">RoomsViewHolder</span>)</span></span> { <span class="hljs-comment">// (2)</span>
        <span class="hljs-keyword">super</span>.onViewRecycled(holder)
        holder.apply {
            itemView.setOnClickListener(<span class="hljs-literal">null</span>)
        }

    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1722604315836.0596')">Copy</button></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>(1) listener is called when someone clicks on an item</p>
</li>
<li>
<p>(2) <strong>it’s very important to clear OnClickListener when a view holder is recycled to prevent memory leaks</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Don’t forget to update <code>RoomsAdapter</code> constructor <code>val adapter = RoomsAdapter(this)</code> in <code>RoomsActivity</code></p>
</div>
<div class="paragraph">
<p>You can also update the <code>android:parentActivityName</code> of the <code>RoomActivity</code> to return on the list after a back button</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_more">More…​</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want more explanations about RecyclerView you can read this <a href="https://codelabs.developers.google.com/codelabs/kotlin-android-training-recyclerview-fundamentals/index.html?index=..%2F..android-kotlin-fundamentals#2">codelabs</a> made by Google</p>
</div>
</div>
</div></div></div></div></app-asciidoc-viewer><!----><app-footer _ngcontent-ng-c582792440 _nghost-ng-c2660501952 ngh="0"><footer _ngcontent-ng-c2660501952><div _ngcontent-ng-c2660501952 class="dm_footer"><div _ngcontent-ng-c2660501952 class="is-small-screen"><p _ngcontent-ng-c2660501952 id="footer-dm_society"> SARL au capital de <i _ngcontent-ng-c2660501952>5000€</i><br _ngcontent-ng-c2660501952> SIREN : 808 720 759, au RCS de Saint-Etienne<br _ngcontent-ng-c2660501952> All right reserved - ©2024 Guillaume EHRET </p></div><div _ngcontent-ng-c2660501952 class="is-large-screen"><div _ngcontent-ng-c2660501952 class="dm_footer__middle"><div _ngcontent-ng-c2660501952 class="dm_society"> Dev-Mind </div><div _ngcontent-ng-c2660501952>SARL au capital de <i _ngcontent-ng-c2660501952>5000€</i></div><div _ngcontent-ng-c2660501952>SIREN : 808 720 759, au RCS de Saint-Etienne</div><div _ngcontent-ng-c2660501952><small _ngcontent-ng-c2660501952>Mise à jour le 02/08/2024</small></div></div><div _ngcontent-ng-c2660501952 class="dm_footer__right"> All right reserved - ©2024 Guillaume EHRET </div></div></div></footer></app-footer></app-root>

<script src="polyfills-A7MJM4D4.js" type="module"></script><script src="main-EXB64UBH.js" type="module"></script>

<script id="ng-state" type="application/json">{"__nghData__":[{},{"t":{"7":"t0"},"c":{"7":[{"i":"t0","r":1}]}},{"c":{"1":[{"i":"c490234363","r":1}]}}]}</script></body></html>