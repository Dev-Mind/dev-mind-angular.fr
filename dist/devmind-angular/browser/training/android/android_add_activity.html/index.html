<!DOCTYPE html><html lang="en" data-critters-container><head>
  <meta charset="utf-8">
  <title>Training</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    body {
      min-height: 100vh;
      max-height: 100vh;
      font-family: "Helvetica", "Arial", "sans-serif";
      padding: 0;
      margin: 0;
    }

    header {
      height: 90px;
      max-height: 90px;
      box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      background-color: white;
      display: -webkit-flex;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
      z-index: 99;
      transition-duration: 0.2s;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-property: max-height, box-shadow;
      position: fixed;
      width: 100%;
      text-align: center;
    }
    header hr {
      width:100%;
      background-color: #424242;
      border-color: #424242;
      display: block;
      border: 0;
      height: 0.5em;
      margin: 0;
    }
    .header-img {
      margin: auto;
      width: 50%;
      padding-top: 0.5em;
      height: 30px;
    }
    .header-img img {
      max-height: 30px !important;
    }
    .header-space {
      min-height: 90px;
    }


    @media screen and (min-width: 901px) {
      header {
        height: 120px;
        max-height: 120px;
      }
      .header-img {
        height: 60px;
      }
      .header-img img {
        max-height: 60px !important;
      }
      .header-space {
        min-height: 120px;
      }
      nav a {
        padding: 6px 24px;
      }
      .nav-home{
        display: block !important;
      }
    }


    nav {
      display: -webkit-flex;
      display: flex;
      margin: auto;
    }

    nav a {
      padding: 0 12px;
      line-height: 28px;
      height: 28px;
      color: #424242;
      margin: auto;
      text-decoration: none;
      text-transform: uppercase;
      font-weight: 600;
      font-size: 13px;
      border-radius: 4px;
    }
    .nav-home{
      display: none;
    }
    nav a > img {
    // height: 20px;
    }

    nav a:hover {
      background-color: #9e9e9e;
    }

    nav .active {
      background-color: rgba(0, 0, 0, 0.14);
    }

    main {
      overflow-x: hidden;
    }

    img, picture {
      max-width: 100%;
      height: auto;
      margin: auto;
    }

    * {
      box-sizing: border-box; /* pour ma√Ætriser width et flex-basis */
    }

    .devmind-section {
      display: block;
      margin: 0 auto;
      max-width: 1600px;
      padding: 60px 40px;
    }

    @media (max-width: 700px) {
      .devmind-section {
        padding: 25px 10px;
      }
    }

    @media (min-width: 701px) and (max-width: 900px) {
      .devmind-section {
        padding: 40px 25px;
      }
    }

    .dm-social {
      min-width: 2em;
      max-width: 2em;
      width: 2em;
      height: 2em;
    }
  </style>
  <script>
    function copyToClipboard(id) {
      const text = document.getElementById(id).innerText
        .replaceAll('~$', '')
        .replaceAll('(1)', '')
        .replaceAll('(2)', '')
        .replaceAll('(3)', '')
        .replaceAll('(4)', '')
        .replaceAll('(5)', '')
        .replaceAll('(6)', '')
        .replaceAll('(7)', '')
        .replaceAll('(8)', '')
        .replaceAll('(9)', '')
        .replaceAll('(10)', '')
      ;
      navigator.clipboard.writeText(text.substring(0, text.length));
    }
  </script>
<style>code[class*=language-]{color:#555;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}.imageblock,.videoblock{text-align:center}.videoblock iframe{max-width:100%}.toc{background:#f0f8ff;padding:1em}h1,h2{font-weight:100}h1{font-size:35px;line-height:38px}.dm-block--blog{width:100%;background-color:#eceff1;color:#424242;padding:0;margin:0}.dm-block--blog a,.dm-block--blog a:hover,.dm-block--blog a:visited{font-weight:700;color:#424242;text-decoration:none;cursor:pointer}.dm-block--blog a:hover{color:#424242;text-decoration:underline}.dm-block--blog .link{display:block}.btn-copy-code{background-color:#fff;border:2px solid white;border-radius:24px;color:#424242!important;margin:1em .5em auto auto;font-weight:700;font-size:16px;display:block;cursor:pointer;width:auto;text-align:center;box-shadow:0 4px 5px #00000024,0 1px 10px #0000001f,0 2px 4px -1px #0003;padding:4px;font-size:small}.btn-copy-code:hover{background-color:#424242;border:2px solid #424242;color:#fff!important;padding:.5em 1em}.text-center{text-align:center}footer{background-color:#424242}.is-small-screen{display:none}.is-large-screen{display:inherit}@media screen and (max-width: 900px){.is-small-screen{display:inherit}.is-large-screen{display:none}}h1,h2{color:#424242;font-weight:100}h1{font-weight:bolder;font-size:35px;line-height:38px}h2{font-size:25px;line-height:28px}@media (max-width: 700px){h1{font-size:28px;line-height:30px}h2{font-size:22px;line-height:24px}}
</style><link rel="stylesheet" href="styles-2TVDB7GC.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles-2TVDB7GC.css"></noscript><style ng-app-id="ng">.dm_footer[_ngcontent-ng-c2660501952]{color:#eee;display:flex;justify-content:space-between;font-size:14px}.dm_footer[_ngcontent-ng-c2660501952]   .dm_society[_ngcontent-ng-c2660501952]{color:#fff}.dm_footer[_ngcontent-ng-c2660501952]   div[_ngcontent-ng-c2660501952]{margin-right:1em;width:100%}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__middle[_ngcontent-ng-c2660501952]{flex-grow:1}.dm_footer[_ngcontent-ng-c2660501952]   .dm_footer__right[_ngcontent-ng-c2660501952]{text-align:right}.dm_footer[_ngcontent-ng-c2660501952]   .is-large-screen[_ngcontent-ng-c2660501952]{padding:.7em;margin:.7em 1em}.dm_footer[_ngcontent-ng-c2660501952]   .is-small-screen[_ngcontent-ng-c2660501952]{padding:0;margin:0 1em;font-size:12px}</style><style ng-app-id="ng">h1{margin-top:.5em}.dm-blog--info-date{font-size:smaller;color:#424242;border:1px solid #aaa;border-radius:24px;padding:.5em 1em;margin-right:.5em;display:inline}.blog-keywords{display:flex;margin-bottom:1em}.blog-keywords .dm-blog--keyword-detail{background-color:#ccc;color:#424242;padding:.5em 1em;margin-right:.5em;border-radius:24px;font-size:smaller}.toc{background-color:#ccc;margin-top:1em;border:1px solid #ccc;padding:1em;border-radius:8px}.toc #toctitle{font-weight:700;margin-bottom:.5em}img{max-width:100%;height:auto}.imageblock>.content{display:flex;justify-content:center;align-items:center}.highlight{display:block;overflow-x:auto;background:#f3f3f3;color:#444;padding:1.5em;box-shadow:0 8px 16px #00000026;border-radius:8px}code.hljs{padding:3px 5px}.hljs-comment{color:#697070}.hljs-punctuation,.hljs-tag{color:#444a}.hljs-tag .hljs-attr,.hljs-tag .hljs-name{color:#444}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-link,.hljs-operator,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#ab5656}.hljs-literal{color:#695}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta .hljs-string{color:#38a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.language-kotlin:before{display:block;float:right;content:"kotlin";font-weight:700;text-transform:uppercase}.language-typescript:before{display:block;float:right;content:"typescript";font-weight:700;text-transform:uppercase}.language-java:before{display:block;float:right;content:"java";font-weight:700;text-transform:uppercase}.language-javascript:before{display:block;float:right;content:"javascript";font-weight:700;text-transform:uppercase}.language-shell:before{display:block;float:right;content:"shell";font-weight:700;text-transform:uppercase}.language-yaml:before{display:block;float:right;content:"yaml";font-weight:700;text-transform:uppercase}.language-json:before{display:block;float:right;content:"json";font-weight:700;text-transform:uppercase}.language-xml:before{display:block;float:right;content:"xml";font-weight:700;text-transform:uppercase}.language-html:before{display:block;float:right;content:"html";font-weight:700;text-transform:uppercase}.language-css:before{display:block;float:right;content:"css";font-weight:700;text-transform:uppercase}.language-scss:before{display:block;float:right;content:"scss";font-weight:700;text-transform:uppercase}
</style></head>
<body><!--nghm-->
  <app-root _nghost-ng-c582792440 ng-version="18.0.0" ngh="2" ng-server-context="ssg"><app-header _ngcontent-ng-c582792440 _nghost-ng-c2882497807 ngh="0"><header _ngcontent-ng-c2882497807><div _ngcontent-ng-c2882497807 class="header-img"><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" href="/"><img _ngcontent-ng-c2882497807 src="img/logo/logo_long.svg" alt="Dev-Mind" title="Dev-Mind"></a></div><nav _ngcontent-ng-c2882497807><a _ngcontent-ng-c2882497807 routerlink="/" aria-label="Accueil" class="nav-home" href="/"><img _ngcontent-ng-c2882497807 src="/img/ic_home_white_24px.svg" rel="start" alt="Accueil"></a><a _ngcontent-ng-c2882497807 routerlink="/formations.html" aria-label="Formations" class="active" href="/formations.html"> Formations</a><a _ngcontent-ng-c2882497807 routerlink="/blog.html" aria-label="Blog" class href="/blog.html">Blog</a><a _ngcontent-ng-c2882497807 routerlink="/experience.html" aria-label="Experience" class href="/experience.html"> Exp√©rience</a></nav><hr _ngcontent-ng-c2882497807></header><div _ngcontent-ng-c2882497807 class="header-space"></div></app-header><router-outlet _ngcontent-ng-c582792440></router-outlet><app-asciidoc-viewer ngh="1"><div class="dm-block--blog"><div class="devmind-section"><h1><!--ngetn--></h1><div class="blog-keywords"><div class="dm-blog--info-date">18/08/2024</div><div class="dm-blog--keyword-detail">Android</div><!---->&nbsp; </div><div class="preview"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a class="link" fragment="#_flask_create_a_new_activity"><img src="/img/ic_flask.svg" style="width: 1em"> : Create a new activity</a></li>
<li><a class="link" fragment="#_intent_how_communicate_with_this_new_component">Intent : how communicate with this new component ?</a></li>
<li><a class="link" fragment="#_flask_build_an_intent_to_open_an_activity"><img src="/img/ic_flask.svg" style="width: 1em"> : Build an intent to open an activity</a></li>
<li><a class="link" fragment="#_flask_create_model_to_manage_room_and_windows"><img src="/img/ic_flask.svg" style="width: 1em"> : Create model to manage room and windows</a></li>
<li><a class="link" fragment="#_flask_update_roomactivity_to_display_all_room_properties"><img src="/img/ic_flask.svg" style="width: 1em"> : Update RoomActivity to display all room properties</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this lesson, you will learn how to create a new View in your app and how to launch it with an Intent</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../../img/training/android/android-add-activity.png" alt="Add activity" width="900">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flask_create_a_new_activity"><img src="/img/ic_flask.svg" style="width: 1em"> : Create a new activity</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Project window</strong>, right-click the app folder and select <strong>New &gt; Compose &gt; Empty Activity</strong>. You can also use menu <strong>File &gt; New &gt; Compose &gt; Empty Activity</strong>. Enter a name for our new activity : <em>RoomActivity</em>. Leave all other properties set to their defaults and click Finish.</p>
<div class="videoblock">
<div class="content">
<iframe width="600" height="330" src="https://www.youtube.com/embed/rAAgTjU-6sc?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
</li>
<li>
<p>Android Studio automatically does does things:</p>
<div class="ulist">
<ul>
<li>
<p>Creates the <strong>RoomActivity</strong> file.</p>
</li>
<li>
<p>Adds the required <strong>&lt;activity&gt;</strong> element in <strong>AndroidManifest.xml</strong> (each activity must be declared in this file).</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For the moment the new activity is empty. We will add some widgets to display a room name.</p>
</div>
<div class="paragraph">
<p>You can also add a new key in the <code>strings.xml</code> file to store the room name</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" id="1731613728152.1895">&lt;string name="act_room_name"&gt;Room name&lt;/string&gt;</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728152.1895')">Copy</button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728156.9028"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomActivity</span> : <span class="hljs-type">ComponentActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContent {
            AutomacorpTheme {
                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding -&gt;
                    RoomDetail(
                        name = <span class="hljs-string">"Android"</span>,
                        modifier = Modifier.padding(innerPadding)
                    )
                }
            }
        }
    }
}

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">RoomDetail</span><span class="hljs-params">(name: <span class="hljs-type">String</span>, modifier: <span class="hljs-type">Modifier</span> = Modifier)</span></span> {
    Column(modifier = modifier.padding(<span class="hljs-number">16.</span>dp)) {
        <span class="hljs-keyword">var</span> nameState <span class="hljs-keyword">by</span> remember { mutableStateOf(name) }
        Text(
            text = stringResource(R.string.act_room_name),
            style = MaterialTheme.typography.labelSmall,
            modifier = Modifier.padding(bottom = <span class="hljs-number">4.</span>dp)
        )
        OutlinedTextField(
            nameState,
            onValueChange = { nameState = it },
            placeholder = { Text(stringResource(R.string.act_room_name)) },
        )
    }

}

<span class="hljs-meta">@Preview(showBackground = true)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">RoomDetailPreview</span><span class="hljs-params">()</span></span> {
    AutomacorpTheme {
        RoomDetail(<span class="hljs-string">"Android"</span>)
    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728156.9028')">Copy</button></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_intent_how_communicate_with_this_new_component">Intent : how communicate with this new component ?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <a href="https://developer.android.com/reference/android/content/Intent">Intent</a> is an object that provides runtime binding between separate components, such as two activities. These activities can be in the same app or not.</p>
</div>
<div class="paragraph">
<p>For example if you need to open a web page you won‚Äôt develop a new browser. You will open this web page in installed browser as Firefox or Chrome.</p>
</div>
<div class="paragraph">
<p>The <a href="https://developer.android.com/reference/android/content/Intent">Intent</a> represents an app‚Äôs intent to do something. You can use intents for a wide variety of tasks, but in this lesson, your intent starts another activity in the same app.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../../img/training/android/newactivity/android-intent.png" alt="Intent" width="700">
</div>
</div>
<div class="paragraph">
<p>The primary information contained in an Intent is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Component name</strong> [optional] The name of the component to start. This information makes an intent explicit or not, meaning that the intent should be delivered only to the app component defined by the component name. Without a component name, the intent is implicit and the system decides which component should receive the intent based on the other intent information (such as the action, data, and category‚Äîdescribed below).</p>
</li>
<li>
<p><strong>Action</strong> A string that specifies the generic action to perform (such as ACTION_VIEW, ACTION_EDIT, ACTION_MAIN, etc.). The action is a string that specifies what the intent should do. For example, ACTION_VIEW might display data to the user, while ACTION_SEND might send data to another app.</p>
</li>
<li>
<p><strong>Data</strong> [optional] A URI that references the data to be acted on by the intent (such as a webpage, a contact record, etc.). The data is a URI that references the data to be acted on by the intent. For example, the data can be a webpage, a contact record, or a file.</p>
</li>
<li>
<p><strong>Extras</strong> [optional] A Bundle of additional information. This information can be used to provide extended information to the component. For example, if the intent is to send an email, the extras can include the email subject, the email text, etc.</p>
</li>
<li>
<p>‚Ä¶‚Äã</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this lab we will open <strong>RoomActivity</strong> when a user will click on <strong>MainActivity</strong> button <strong>Open Room name</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flask_build_an_intent_to_open_an_activity"><img src="/img/ic_flask.svg" style="width: 1em"> : Build an intent to open an activity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It‚Äôs a good practice to define keys for intent extras with your app‚Äôs package name as a prefix. This ensures that the keys are unique, in case your app interacts with other apps. You can define a companion object in the activity class to store these keys as constant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728160.3113"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {

    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> ROOM_PARAM = <span class="hljs-string">"com.automacorp.room.attribute"</span>
    }

    <span class="hljs-comment">// ...</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731613728160.3113')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>We will update the <code>onSayHelloButtonClick</code> method to open the <code>RoomActivity</code> with the name filled in the <code>MainActivity</code> (you can remove the Toast message).</p>
</div>
<div class="paragraph">
<p>For that we will define an Intent, target <code>RoomActivity</code>, and put the room name filled in <code>MainActivity</code> in the sent attributes (extra).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728162.8604"><span class="hljs-keyword">val</span> onSayHelloButtonClick: (name: String) <span class="hljs-meta">-&gt;</span> <span class="hljs-built_in">Unit</span> = { name <span class="hljs-meta">-&gt;</span>
  <span class="hljs-keyword">val</span> intent = Intent(<span class="hljs-keyword">this</span>, RoomActivity::<span class="hljs-keyword">class</span>.java).apply {
    putExtra(ROOM_PARAM, name)
  }
  startActivity(intent)
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728162.8604')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>RoomActivity</code> class, we will read the name sent in the intent and update the Textview with this name. The job is done in the <code>onCreate</code> method. All parameters sent in the intent are stored in the <code>Bundle</code> object used as argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728163.4365"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        <span class="hljs-keyword">val</span> param = intent.getStringExtra(MainActivity.ROOM_PARAM)
        enableEdgeToEdge()
        setContent {
            AutomacorpTheme {
                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding <span class="hljs-meta">-&gt;</span>
                    RoomDetail(
                        name = param ?: <span class="hljs-string">""</span>,
                        modifier = Modifier.padding(innerPadding)
                    )
                }
            }
        }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728163.4365')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>It‚Äôs time to test yours changes.</p>
</div>
<div class="paragraph">
<p>Click <strong>Apply Changes</strong> <span class="image"><img src="../../img/training/android/android-studio-apply.svg" alt="Apply changes"></span>  in the toolbar to run the app. Type a window name in the text field and click on the button to see the message in the second activity</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flask_create_model_to_manage_room_and_windows"><img src="/img/ic_flask.svg" style="width: 1em"> : Create model to manage room and windows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A room is defined by several properties</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an id</p>
</li>
<li>
<p>a name</p>
</li>
<li>
<p>a current temperature (this property can be nullable if no data is available) : in the backend app this value is read by a sensor, but here we just need the value of the current temperature</p>
</li>
<li>
<p>a target temperature (this property can be nullable if no data is available)</p>
</li>
<li>
<p>a list of window : for the moment we won‚Äôt display these data but we will</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A Window is defined by several properties</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an id</p>
</li>
<li>
<p>a room</p>
</li>
<li>
<p>a status : : in the backend app this value is read by a sensor, but here we just need the value OPENED or CLOSED</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We are going to create classes to represent windows and rooms.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Project window</strong>, right-click the package <em>com.automacorp</em> and select <strong>New &gt; package</strong>.</p>
</li>
<li>
<p>New package will be called <strong>model</strong>. Select this package, redo a right-click and select <strong>New &gt; Kotlin File/Class</strong>.</p>
</li>
<li>
<p>Fill a name. For example <strong>RoomDto</strong> (dto = data transfer object) and create window properties. You can copy this code</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728165.4985"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomDto</span>(
    <span class="hljs-keyword">val</span> id: <span class="hljs-built_in">Long</span>,
    <span class="hljs-keyword">val</span> name: String,
    <span class="hljs-keyword">val</span> currentTemperature: <span class="hljs-built_in">Double</span>?,
    <span class="hljs-keyword">val</span> targetTemperature: <span class="hljs-built_in">Double</span>?,
    <span class="hljs-keyword">val</span> windows: <span class="hljs-symbol">List&lt;WindowDto&gt;,
)</span></code><button class="btn-copy-code" onclick="copyToClipboard('1731613728165.4985')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>Note: when a value is nullable you need to suffix type with ?. In our example currentTemperature can be null, so type is Double? and not Double</p>
</div>
</li>
<li>
<p>Redo same steps to create <strong>WindowDto</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728166.6"><span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WindowStatus</span> { OPENED, CLOSED}

<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WindowDto</span>(
    <span class="hljs-keyword">val</span> id: <span class="hljs-built_in">Long</span>,
    <span class="hljs-keyword">val</span> name: String,
    <span class="hljs-keyword">val</span> roomName: String,
    <span class="hljs-keyword">val</span> roomId: <span class="hljs-built_in">Long</span>,
    <span class="hljs-keyword">val</span> windowStatus: WindowStatus
)</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728166.6')">Copy</button></pre>
</div>
</div>
</li>
<li>
<p>We will now create a service class to manage these windows. We will write 2 methods : one to find all building windows and a second to load only one window by its id. For the moment we will use fake data. In a next lesson we will learn how call a remote service to load real data. This class can be created in the package <code>com.automacorp.service</code></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728173.943"><span class="hljs-keyword">object</span> RoomService {
    <span class="hljs-keyword">val</span> ROOM_KIND: <span class="hljs-symbol">List&lt;String&gt; = listOf(<span class="hljs-string">"Room"</span>, <span class="hljs-string">"Meeting"</span>, <span class="hljs-string">"Laboratory"</span>, <span class="hljs-string">"Office"</span>, <span class="hljs-string">"Boardroom"</span>)
    <span class="hljs-keyword">val</span> ROOM_NUMBER: <span class="hljs-symbol">List&lt;Char&gt; = (<span class="hljs-string">'A'</span>..<span class="hljs-string">'Z'</span>).toList()
    <span class="hljs-keyword">val</span> WINDOW_KIND: <span class="hljs-symbol">List&lt;String&gt; = listOf(<span class="hljs-string">"Sliding"</span>, <span class="hljs-string">"Bay"</span>, <span class="hljs-string">"Casement"</span>, <span class="hljs-string">"Hung"</span>, <span class="hljs-string">"Fixed"</span>)

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">generateWindow</span><span class="hljs-params">(id: <span class="hljs-type">Long</span>, roomId: <span class="hljs-type">Long</span>, roomName: <span class="hljs-type">String</span>)</span></span>: WindowDto {
        <span class="hljs-keyword">return</span> WindowDto(
            id = id,
            name = <span class="hljs-string">"${ WINDOW_KIND.random()} Window $id"</span>,
            roomName = roomName,
            roomId = roomId,
            windowStatus = WindowStatus.values().random()
        )
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">generateRoom</span><span class="hljs-params">(id: <span class="hljs-type">Long</span>)</span></span>: RoomDto {
        <span class="hljs-keyword">val</span> roomName = <span class="hljs-string">"${ROOM_NUMBER.random()}$id ${ROOM_KIND.random()}"</span>
        <span class="hljs-keyword">val</span> windows = (<span class="hljs-number">1.</span>.(<span class="hljs-number">1.</span><span class="hljs-number">.6</span>).random()).map { generateWindow(it.toLong(), id, roomName) }
        <span class="hljs-keyword">return</span> RoomDto(
            id = id,
            name = roomName,
            currentTemperature = (<span class="hljs-number">15.</span><span class="hljs-number">.30</span>).random().toDouble(),
            targetTemperature = (<span class="hljs-number">15.</span><span class="hljs-number">.22</span>).random().toDouble(),
            windows = windows
        )
    }

    <span class="hljs-comment">// Create 50 rooms</span>
    <span class="hljs-keyword">val</span> ROOMS = (<span class="hljs-number">1.</span><span class="hljs-number">.50</span>).map { generateRoom(it.toLong()) }.toMutableList()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>: <span class="hljs-symbol">List&lt;RoomDto&gt; {
        <span class="hljs-comment">// TODO return all rooms sorted by name</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findById</span><span class="hljs-params">(id: <span class="hljs-type">Long</span>)</span></span>: RoomDto? {
        <span class="hljs-comment">// TODO return the room with the given id or null</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findByName</span><span class="hljs-params">(name: <span class="hljs-type">String</span>)</span></span>: RoomDto? {
        <span class="hljs-comment">// TODO return the room with the given name or null</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateRoom</span><span class="hljs-params">(id: <span class="hljs-type">Long</span>, room: <span class="hljs-type">RoomDto</span>)</span></span>: RoomDto {
        <span class="hljs-comment">// TODO update an existing room with the given values</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findByNameOrId</span><span class="hljs-params">(nameOrId: <span class="hljs-type">String</span>?)</span></span>: RoomDto? {
        <span class="hljs-keyword">if</span> (nameOrId != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (nameOrId.isDigitsOnly()) {
                findById(nameOrId.toLong())
            } <span class="hljs-keyword">else</span> {
                findByName(nameOrId)
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
}</span></span></span></span></code><button class="btn-copy-code" onclick="copyToClipboard('1731613728173.943')">Copy</button></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For the moment the given class is not complete. You have to implement each method. For example the <code>updateRoom</code> method can be implemented like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728175.308"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateRoom</span><span class="hljs-params">(id: <span class="hljs-type">Long</span>, room: <span class="hljs-type">RoomDto</span>)</span></span>: RoomDto? {
    <span class="hljs-keyword">val</span> index = ROOMS.indexOfFirst { it.id == id }
    <span class="hljs-keyword">val</span> updatedRoom = findById(id)?.copy(
        name = room.name,
        targetTemperature = room.targetTemperature,
        currentTemperature = room.currentTemperature
    ) ?: <span class="hljs-keyword">throw</span> IllegalArgumentException()
    <span class="hljs-keyword">return</span> ROOMS.<span class="hljs-keyword">set</span>(index, updatedRoom)
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728175.308')">Copy</button></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flask_update_roomactivity_to_display_all_room_properties"><img src="/img/ic_flask.svg" style="width: 1em"> : Update RoomActivity to display all room properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will update the existing <code>RoomActivity</code> to display more data.</p>
</div>
<div class="paragraph">
<p>You can add a new keys in the <code>strings.xml</code> file to store the room name</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" id="1731613728180.5005">    &lt;string name="act_room_name"&gt;Room name&lt;/string&gt;
    &lt;string name="act_room_none"&gt;No round found for this id or name&lt;/string&gt;
    &lt;string name="act_room_current_temperature"&gt;Current temperature&lt;/string&gt;
    &lt;string name="act_room_target_temperature"&gt;Target temperature&lt;/string&gt;</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728180.5005')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>We will search for a room that matches the name given in the Intent or if the user fill the room ID we will directly display the corresponding room.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728181.9724"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
    enableEdgeToEdge()
    <span class="hljs-keyword">val</span> param = intent.getStringExtra(MainActivity.ROOM_PARAM)
    <span class="hljs-keyword">val</span> room = RoomService.findByNameOrId(param)

    setContent {
        AutomacorpTheme {
            Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding <span class="hljs-meta">-&gt;</span>
                <span class="hljs-keyword">if</span> (room != <span class="hljs-literal">null</span>) {
                    RoomDetail(room,Modifier.padding(innerPadding))
                } <span class="hljs-keyword">else</span> {
                    NoRoom(Modifier.padding(innerPadding))
                }

            }
        }
    }
}</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728181.9724')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 1</strong>. Create a new composable called NoRoom to display a message (key <code>act_room_none</code>) when no room is found</p>
</div>
<div class="paragraph">
<p><strong>Step 2</strong>. In the composable RoomDetail, display the room name, the current temperature and the target temperature. As we want to bind the field with the room object, we will use the <code>remember</code> function to store the room object in a mutable state.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728183.8086">    <span class="hljs-keyword">var</span> room <span class="hljs-keyword">by</span> remember { mutableStateOf(roomDto) }
    Column(modifier = modifier.padding(<span class="hljs-number">16.</span>dp)) {
        <span class="hljs-comment">// ...</span>
        OutlinedTextField(
            room.name,
            modifier = Modifier.fillMaxWidth(),
            onValueChange = { room = room.copy(name = it) },
            placeholder = { Text(stringResource(R.string.act_room_name)) },
        )
        <span class="hljs-comment">// ...</span>
    }</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728183.8086')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3</strong>. Add a <code>Text</code> to display the current temperature. This data is not updatable so we don‚Äôt need to use a TextField</p>
</div>
<div class="paragraph">
<p><strong>Step 4</strong>. Add a <code>OutlinedTextField</code> to display the target temperature. This data is updatable so we need to use a TextField. In place of this <code>OutlinedTextField</code> you can use a  <code>Slider</code> (more detail on <a href="https://developer.android.com/develop/ui/compose/components/slider" class="bare">https://developer.android.com/develop/ui/compose/components/slider</a>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" id="1731613728184.4548">    Slider(
        value = room.targetTemperature?.toFloat() ?: <span class="hljs-number">18.0f</span>,
        onValueChange = { room = room.copy(targetTemperature = it.toDouble()) },
        colors = SliderDefaults.colors(
            thumbColor = MaterialTheme.colorScheme.secondary,
            activeTrackColor = MaterialTheme.colorScheme.secondary,
            inactiveTrackColor = MaterialTheme.colorScheme.secondaryContainer,
        ),
        steps = <span class="hljs-number">0</span>,
        valueRange = <span class="hljs-number">10f</span>.<span class="hljs-number">.28f</span>
    )
    Text(text = (round((room.targetTemperature ?: <span class="hljs-number">18.0</span>) * <span class="hljs-number">10</span>) / <span class="hljs-number">10</span>).toString())</code><button class="btn-copy-code" onclick="copyToClipboard('1731613728184.4548')">Copy</button></pre>
</div>
</div>
<div class="paragraph">
<p>This image below show you an implementation example</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../../img/training/android/newactivity/example.png" alt="Activity room" width="700">
</div>
</div>
</div>
</div></div></div></div></app-asciidoc-viewer><!----><app-footer _ngcontent-ng-c582792440 _nghost-ng-c2660501952 ngh="0"><footer _ngcontent-ng-c2660501952><div _ngcontent-ng-c2660501952 class="dm_footer"><div _ngcontent-ng-c2660501952 class="is-small-screen"><p _ngcontent-ng-c2660501952 id="footer-dm_society"> SARL au capital de <i _ngcontent-ng-c2660501952>5000‚Ç¨</i><br _ngcontent-ng-c2660501952> SIREN : 808 720 759, au RCS de Saint-Etienne<br _ngcontent-ng-c2660501952> All right reserved - ¬©2024 Guillaume EHRET </p></div><div _ngcontent-ng-c2660501952 class="is-large-screen"><div _ngcontent-ng-c2660501952 class="dm_footer__middle"><div _ngcontent-ng-c2660501952 class="dm_society"> Dev-Mind </div><div _ngcontent-ng-c2660501952>SARL au capital de <i _ngcontent-ng-c2660501952>5000‚Ç¨</i></div><div _ngcontent-ng-c2660501952>SIREN : 808 720 759, au RCS de Saint-Etienne</div><div _ngcontent-ng-c2660501952><small _ngcontent-ng-c2660501952>Mise √† jour le 14/11/2024</small></div></div><div _ngcontent-ng-c2660501952 class="dm_footer__right"> All right reserved - ¬©2024 Guillaume EHRET </div></div></div></footer></app-footer></app-root>

<script src="polyfills-A7MJM4D4.js" type="module"></script><script src="main-RCAYVOUE.js" type="module"></script>

<script id="ng-state" type="application/json">{"__nghData__":[{},{"t":{"7":"t0"},"c":{"7":[{"i":"t0","r":1}]}},{"c":{"1":[{"i":"c490234363","r":1}]}}]}</script></body></html>